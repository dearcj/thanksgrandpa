!function(e,n){"use strict";var t="undefined"!=typeof e.VKAdman?e.VKAdman:function(){function t(t,o){function a(){function a(){setTimeout(function(){try{n.getElementById("vk_rb_adWrapper").parentNode.removeChild(n.getElementById("vk_rb_adWrapper"))}catch(e){}},500)}if(Y&&Q){S();var i=n.createElement("div");R=n.createElement("div"),R.id="vk_rb_adWrapper",n.body.appendChild(R),i.id="vk_rb_adContainer",R.appendChild(i);for(var d in o){var l=U.slice(-1);"&"!=l&&(U+="&"),U+=d+"="+o[d]}M=T(U,"","vk_rb_adContainer",null,!0,function(){e.containerLoadedHandler=function(){M.init(t)},e.admanEventHandler=function(e){"adBannerStarted"==e?(X=!0,R.className=R.className+=" ready",J.onStarted&&J.onStarted()):"adCompleted"==e?(J.onNoAds&&!X?J.onNoAds():J.onCompleted&&J.onCompleted(),a()):"adStopped"==e?(J.onSkipped&&J.onSkipped(),a()):"adClicked"==e&&J.onClicked&&J.onClicked()}},function(){try{P=n.createElement("div"),x(P,"click",function(e){"vk_rb_adSkipper"==e.target.id?p():"vk_rb_adSoundController"==e.target.id&&u()}),P.id="vk_rb_adHeader",R.className=R.className+="ready html",i.appendChild(P),j=document.createElement("video"),i.appendChild(j),o=o||{},o.content_id=t,r({params:o})}catch(e){}})}}"undefined"!=typeof VK?VK.api("users.get",{fields:"sex,bdate"},function(e){if(e.response){var n=e.response[0];o=o||{},n.sex&&(o.g=3-n.sex),n.bdate&&(o.a=O(n.bdate.split(".").reverse().join("/"))),Y=!0,a()}else Y=!0,a()}):(Y=!0,a()),D(e,function(){Q=!0,a()})}function r(n){var t=(new Date).getTime();e["vk_Callback"+t]=function(e){if(clearTimeout(V),!e[0]||!e[0].html)return void k({message:"JSONP error"});try{var n=JSON.parse(e[0].html)}catch(t){return $&&console&&console.log&&console.log("parsing error"),void k({message:"JSON parsing error",error:t})}if(n&&!A(n)){H=n.sections,I=n.settings;var r=H?H.preroll:null;r&&r.length?(a(),J.onReady&&J.onReady({settings:I})):(J.onReady&&J.onReady({settings:I,noAd:!0}),J.onNoAds&&J.onNoAds(),m())}c("Data recieved:"),$&&console&&console.log&&console.log(n)},W=n.slot?n.slot:W;var r=n.params&&"object"==typeof n.params?n.params:null,i="//ad.mail.ru/adq/?q="+W+"&callback=vk_Callback"+t;for(var d in r){var l=i.slice(-1);"&"!=l&&(i+="&"),i+=d+"="+r[d]}c("URL "+i+" is requested to procceed"),W&&j?(V=setTimeout(o,z),L({url:i,dataType:"jsonp",jsonp:!1})):k(W?{message:"DOM VideoContainer not found"}:{message:"slot not found"})}function o(){clearTimeout(V),k({message:"Network error"})}function a(){j.addEventListener("ended",g),j.addEventListener("timeupdate",h),j.addEventListener("abort",y),j.addEventListener("error",k),j.addEventListener("play",b),j.addEventListener("pause",_),j.addEventListener("click",C),c("AdmanHTML container created. Listeners intialized."),s()}function i(e,n,t){var r=[];for(var o in e)e[o]&&e[o][n]&&e[o][n]==t&&r.push(e[o]);return 1==r.length?r[0]:r}function d(e){if(!B)return void k({message:"Statistics error: "+e});var n=i(B,"type",e),t="[object Array]"==Object.prototype.toString.call(n);if(!n||!n.url&&!t)return void k({message:"Action statistics not found: "+e,unloggable:!0});if(t)for(var r=n.length-1;r>=0;r--)(new Image).src=unescape(n[r].url);else(new Image).src=unescape(n.url);c(e+" statistics invoked")}function l(e){if(!B)return void k({message:"All statistics for durations not found"});var n=i(B,"thresholdPValue",e);return n&&n.url?(c("Duration "+e+" statistics invoked"),void((new Image).src=unescape(n.url))):void k({message:"Duration statistics not found"})}function c(e){$&&console&&console.log&&console.log(e)}function s(e){if(K=e&&e.section&&"overlay|pauseroll|preroll|middleroll|postroll".indexOf(e.section)>=0?e.section:"preroll",!H||H&&!H[K]||H&&H[K]&&!H[K].length)return k({message:"Sections or prerolls are not laoded"}),null;B=H[K][0].statistics;var n=(H[K][0].duration,H[K][0].src);return-1==n.toLowerCase().indexOf(".mp4")?(k({message:"Video ad isn't playable in HTML5"}),null):(j.src=n,j.load(),j.play(),E(),c("Video "+n+" started"),I[K])}function p(){j&&(J.onSkipped&&J.onSkipped(),d("closedByUser"),v())}function u(e){void 0===e&&(e=j.volume?0:1),j.volume=0>e?0:e>1?1:e,d(0==e?"volumeOff":"volumeOn")}function v(){j&&(j.removeEventListener("ended",g),j.removeEventListener("timeupdate",h),j.removeEventListener("abort",y),j.removeEventListener("error",k),j.removeEventListener("play",b),j.removeEventListener("pause",_),j.removeEventListener("click",C),j.pause(),j.src="",m()),c("Video stopped")}function m(){j=null,c("Video destroyed"),R.parentNode.removeChild(R)}function f(e){var n=j.currentTime>I.preroll.allowCloseDelay?"<div id='vk_rb_adSkipper' class='vk_rb_adSkipper'>Пропустить рекламу →</div>":"<div class='vk_rb_adSkipper'>Можно пропустить через "+(Math.floor(I.preroll.allowCloseDelay-j.currentTime)+1)+" сек.</div>",t="<div id='vk_rb_adSoundController' "+(j.volume?"":"class='off'")+"></div>";P.innerHTML="До конца рекламы осталось <b>"+e+"</b> секунд"+t+n}function g(){d("playbackCompleted"),J.onCompleted&&J.onCompleted(),v()}function h(){var e=j.duration-j.currentTime;f(Math.floor(e)),J.onTimeRemained&&J.onTimeRemained({remained:e,percent:parseInt(j.currentTime/j.duration*100),duration:j.duration,currentTime:j.currentTime}),0==q&&j.currentTime>0?(d("playbackStarted"),q++):1==q&&j.currentTime/j.duration>=.25?(q++,l(25)):2==q&&j.currentTime/j.duration>=.5?(q++,l(50)):3==q&&j.currentTime/j.duration>=.75?(q++,l(75)):4==q&&j.currentTime/j.duration>=.99&&(q++,l(100))}function y(){J.onStopped&&J.onStopped()}function k(e){clearTimeout(V),e&&!e.unloggable&&(e.message&&((new Image).src="//ad.mail.ru/admanhtml/?app=admanhtml&ver="+F+"&error="+encodeURI(e.message)+"&slot="+W),J.onError&&J.onError(e),e.message&&$&&console&&console.warn&&console.warn("Error (unloggable): "+e.message)),m()}function b(){clearTimeout(V),G=!0,J.onPlay&&J.onPlay()}function _(){d("playbackPaused"),J.onPaused&&J.onPaused()}function C(e){if(G){var n=H[K][0].urlToNavigateOnClick;window.open(n,"_blank"),d("click"),J.onClicked&&J.onClicked(e)}else s()}function w(e){return e.preventDefault(),!1}function E(){j.addEventListener("contextmenu",w)}function S(){var e=document.createElement("style");e.type="text/css",e.innerHTML="#vk_rb_adWrapper.ready{width:100%;height:100%;}#vk_rb_adWrapper{width:1px;height:1px;background:#f0f2f5;top:0;left:0;position:absolute;z-index:2147483647;}.ready #vk_rb_adContainer{width:660px;height:434px}#vk_rb_adContainer{width:1px;height:1px;position:absolute;left:50%;margin-left:-330px;top:100px}#vk_rb_adWrapper.html #vk_rb_adContainer{background:#FFF;border:1px solid #e4e6e9;-webkit-box-shadow:0 0 5px rgba(230,235,240,.7);-moz-box-shadow:0 0 5px rgba(230,235,240,.7);box-shadow:0 0 5px rgba(230,235,240,.7)}#vk_rb_adSoundController{display:inline-block;width:22px;height:22px;margin:-7px 10px;background:url(//r.mradx.net/img/10/2B6F44.gif) 50% 50% no-repeat;cursor:pointer}#vk_rb_adSoundController.off{background:url(//r.mradx.net/img/C4/C13261.gif) left top no-repeat}#vk_rb_adContainer video{margin:10px}#vk_rb_adHeader{font:12px/54px arial,sans-serif;border-bottom:1px solid #e4e6e9;position:relative;top:0;width:90%;height:54px;padding:0 5%}#vk_rb_adSkipper{cursor:pointer;text-decoration:underline}.vk_rb_adSkipper{font:14px/54px arial,sans-serif;float:right;color:#3e5167;display:inline-block}",n.getElementsByTagName("head")[0].appendChild(e)}function T(e,n,t,r,o,a,i){function d(e,n,t,r){function o(e){try{var n=e.GetVariable("$version").split(" ")[1].split(",")[0];return n}catch(t){return null}}if(typeof window.ActiveXObject!=m)try{e=new ActiveXObject(u+"."+u)}catch(a){return void l(t)}if(typeof p.plugins!=m)try{return r=p.plugins[v].description.replace(/^.*\s+(\S+\s+\S+$)/,"$1").split(".")[0],void(typeof n==f&&n(r))}catch(a){}return typeof e.GetVariable!=m&&(r=o(e))?void n(r):C?(setTimeout(function(){d(e,n,t)},10),void C--):void l(t)}function l(e){try{c.parentNode.replaceChild(_,c)}catch(t){}_.innerHTML='<img alt="" src="'+n+'" />',r&&r.link1&&(_.innerHTML='<a href="'+r.link1+'">'+_.innerHTML+"</a>"),typeof e==f&&e()}var c,s=document,p=navigator,u="ShockwaveFlash",v="Shockwave Flash",m="undefined",f="function",g=function(n){var r=function(e,n,t){var r=s.createElement("param");r.name=n,r.value=t,e.appendChild(r)},a=e,i=s.createElement("object");return i.type="application/x-shockwave-flash",i.data=a,r(i,"movie",a),r(i,"allowscriptaccess",o?"always":"never"),r(i,"flashvars",b),r(i,"wmode","transparent"),n.parentNode.replaceChild(i,n),i.id=t,i},h=function(e){return f==typeof encodeURIComponent?encodeURIComponent(e):escape(e)},y=function(e,n){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.call(null,e[t],t,e)},k=function(e){var n="";return y(e,function(e,t){(0===e||e)&&(n+="&"+t+"="+h(e))}),n},b=k(r),_=s.getElementById(t),C=30,w=!1;return w?(c=_,c.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="'+t+'"><param name="movie" value="'+e+'"><param name="allowscriptaccess" value="'+(o?"always":"never")+'"><param name="flashvars" value="'+b+'"><param name="wmode" value="transparent"></object>',c=s.getElementById(t)):c=g(_),d(c,a,i),c}function x(e,n,t,r){e.addEventListener?e.addEventListener(n,t,r||!1):e.attachEvent&&e.attachEvent("on"+n,t)}function L(e){if("jsonp"!=e.dataType)throw new Error("not implemented in mock");var n=document.createElement("script");n.src=e.url,document.body.appendChild(n)}function N(e,n){var t;for(t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t]);return e}function A(e){var n;for(n in e)return!1;return!0}function O(e){var n=new Date,t=new Date(e),r=n.getFullYear()-t.getFullYear(),o=n.getMonth()-t.getMonth();return(0>o||0===o&&n.getDate()<t.getDate())&&r--,r}function D(e,n){var t=!1,r=!0,o=e.document,a=o.documentElement,i=o.addEventListener,d=i?"addEventListener":"attachEvent",l=i?"removeEventListener":"detachEvent",c=i?"":"on",s=function(r){("readystatechange"!=r.type||"complete"==o.readyState)&&(("load"==r.type?e:o)[l](c+r.type,s,!1),!t&&(t=!0)&&n.call(e,r.type||r))},p=function(){try{a.doScroll("left")}catch(e){return void setTimeout(p,50)}s("poll")};if("complete"==o.readyState)n.call(e,"lazy");else{if(!i&&a.doScroll){try{r=!e.frameElement}catch(u){}r&&p()}o[d](c+"DOMContentLoaded",s,!1),o[d](c+"readystatechange",s,!1),e[d](c+"load",s,!1)}}var j,M,V,H,I,B,P,R,F="1.4",W=2060,K="preroll",U="//rs.mail.ru/static/vkcontainer.swf?",z=5e3,q=0,J={},$=!1,G=!1,X=!1,Y=!1,Q=!1;return N(this,{setupPreroll:t,onNoAds:function(e){J.onNoAds=function(n){e(N({eventType:"onNoAds"},n))}},onStarted:function(e){J.onStarted=function(n){e(N({eventType:"onStarted"},n))}},onCompleted:function(e){J.onCompleted=function(n){e(N({eventType:"onCompleted"},n))}},onSkipped:function(e){J.onSkipped=function(n){e(N({eventType:"onSkipped"},n))}},onClicked:function(e){J.onClicked=function(n){e(N({eventType:"onClicked"},n))}}}),this};e.VKAdman=t}(window,window.document);