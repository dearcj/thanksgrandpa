!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.p2=e()}}(function(){var e,t,n;return function r(e,t,n){function i(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=t[o]={exports:{}};e[o][0].call(f.exports,function(t){var n=e[o][1][t];return i(n?n:t)},f,f.exports,r,e,t,n)}return t[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,n){(function(t,r,i,s,o,u,a,f,l){function i(e,t,n){if(!(this instanceof i))return new i(e,t,n);var r=typeof e;if(t==="base64"&&r==="string"){e=j(e);while(e.length%4!==0){e=e+"="}}var s;if(r==="number")s=R(e);else if(r==="string")s=i.byteLength(e,t);else if(r==="object")s=R(e.length);else throw new Error("First argument needs to be a number, array or string.");var o;if(i._useTypedArrays){o=I(new Uint8Array(s))}else{o=this;o.length=s;o._isBuffer=true}var u;if(i._useTypedArrays&&typeof Uint8Array==="function"&&e instanceof Uint8Array){o._set(e)}else if(z(e)){for(u=0;u<s;u++){if(i.isBuffer(e))o[u]=e.readUInt8(u);else o[u]=e[u]}}else if(r==="string"){o.write(e,0,t)}else if(r==="number"&&!i._useTypedArrays&&!n){for(u=0;u<s;u++){o[u]=0}}return o}function p(e,t,n,r){n=Number(n)||0;var s=e.length-n;if(!r){r=s}else{r=Number(r);if(r>s){r=s}}var o=t.length;et(o%2===0,"Invalid hex string");if(r>o/2){r=o/2}for(var u=0;u<r;u++){var a=parseInt(t.substr(u*2,2),16);et(!isNaN(a),"Invalid hex string");e[n+u]=a}i._charsWritten=u*2;return u}function d(e,t,n,r){var s=i._charsWritten=K(X(t),e,n,r);return s}function v(e,t,n,r){var s=i._charsWritten=K(V(t),e,n,r);return s}function m(e,t,n,r){return v(e,t,n,r)}function g(e,t,n,r){var s=i._charsWritten=K(J(t),e,n,r);return s}function y(e,t,n,r){var s=i._charsWritten=K($(t),e,n,r);return s}function b(e,t,n){if(t===0&&n===e.length){return c.fromByteArray(e)}else{return c.fromByteArray(e.slice(t,n))}}function w(e,t,n){var r="";var i="";n=Math.min(e.length,n);for(var s=t;s<n;s++){if(e[s]<=127){r+=Q(i)+String.fromCharCode(e[s]);i=""}else{i+="%"+e[s].toString(16)}}return r+Q(i)}function E(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;i++)r+=String.fromCharCode(e[i]);return r}function S(e,t,n){return E(e,t,n)}function x(e,t,n){var r=e.length;if(!t||t<0)t=0;if(!n||n<0||n>r)n=r;var i="";for(var s=t;s<n;s++){i+=W(e[s])}return i}function T(e,t,n){var r=e.slice(t,n);var i="";for(var s=0;s<r.length;s+=2){i+=String.fromCharCode(r[s]+r[s+1]*256)}return i}function N(e,t,n,r){if(!r){et(typeof n==="boolean","missing or invalid endian");et(t!==undefined&&t!==null,"missing offset");et(t+1<e.length,"Trying to read beyond buffer length")}var i=e.length;if(t>=i)return;var s;if(n){s=e[t];if(t+1<i)s|=e[t+1]<<8}else{s=e[t]<<8;if(t+1<i)s|=e[t+1]}return s}function C(e,t,n,r){if(!r){et(typeof n==="boolean","missing or invalid endian");et(t!==undefined&&t!==null,"missing offset");et(t+3<e.length,"Trying to read beyond buffer length")}var i=e.length;if(t>=i)return;var s;if(n){if(t+2<i)s=e[t+2]<<16;if(t+1<i)s|=e[t+1]<<8;s|=e[t];if(t+3<i)s=s+(e[t+3]<<24>>>0)}else{if(t+1<i)s=e[t+1]<<16;if(t+2<i)s|=e[t+2]<<8;if(t+3<i)s|=e[t+3];s=s+(e[t]<<24>>>0)}return s}function k(e,t,n,r){if(!r){et(typeof n==="boolean","missing or invalid endian");et(t!==undefined&&t!==null,"missing offset");et(t+1<e.length,"Trying to read beyond buffer length")}var i=e.length;if(t>=i)return;var s=N(e,t,n,true);var o=s&32768;if(o)return(65535-s+1)*-1;else return s}function L(e,t,n,r){if(!r){et(typeof n==="boolean","missing or invalid endian");et(t!==undefined&&t!==null,"missing offset");et(t+3<e.length,"Trying to read beyond buffer length")}var i=e.length;if(t>=i)return;var s=C(e,t,n,true);var o=s&2147483648;if(o)return(4294967295-s+1)*-1;else return s}function A(e,t,n,r){if(!r){et(typeof n==="boolean","missing or invalid endian");et(t+3<e.length,"Trying to read beyond buffer length")}return h.read(e,t,n,23,4)}function O(e,t,n,r){if(!r){et(typeof n==="boolean","missing or invalid endian");et(t+7<e.length,"Trying to read beyond buffer length")}return h.read(e,t,n,52,8)}function M(e,t,n,r,i){if(!i){et(t!==undefined&&t!==null,"missing value");et(typeof r==="boolean","missing or invalid endian");et(n!==undefined&&n!==null,"missing offset");et(n+1<e.length,"trying to write beyond buffer length");G(t,65535)}var s=e.length;if(n>=s)return;for(var o=0,u=Math.min(s-n,2);o<u;o++){e[n+o]=(t&255<<8*(r?o:1-o))>>>(r?o:1-o)*8}}function _(e,t,n,r,i){if(!i){et(t!==undefined&&t!==null,"missing value");et(typeof r==="boolean","missing or invalid endian");et(n!==undefined&&n!==null,"missing offset");et(n+3<e.length,"trying to write beyond buffer length");G(t,4294967295)}var s=e.length;if(n>=s)return;for(var o=0,u=Math.min(s-n,4);o<u;o++){e[n+o]=t>>>(r?o:3-o)*8&255}}function D(e,t,n,r,i){if(!i){et(t!==undefined&&t!==null,"missing value");et(typeof r==="boolean","missing or invalid endian");et(n!==undefined&&n!==null,"missing offset");et(n+1<e.length,"Trying to write beyond buffer length");Y(t,32767,-32768)}var s=e.length;if(n>=s)return;if(t>=0)M(e,t,n,r,i);else M(e,65535+t+1,n,r,i)}function P(e,t,n,r,i){if(!i){et(t!==undefined&&t!==null,"missing value");et(typeof r==="boolean","missing or invalid endian");et(n!==undefined&&n!==null,"missing offset");et(n+3<e.length,"Trying to write beyond buffer length");Y(t,2147483647,-2147483648)}var s=e.length;if(n>=s)return;if(t>=0)_(e,t,n,r,i);else _(e,4294967295+t+1,n,r,i)}function H(e,t,n,r,i){if(!i){et(t!==undefined&&t!==null,"missing value");et(typeof r==="boolean","missing or invalid endian");et(n!==undefined&&n!==null,"missing offset");et(n+3<e.length,"Trying to write beyond buffer length");Z(t,3.4028234663852886e38,-3.4028234663852886e38)}var s=e.length;if(n>=s)return;h.write(e,t,n,r,23,4)}function B(e,t,n,r,i){if(!i){et(t!==undefined&&t!==null,"missing value");et(typeof r==="boolean","missing or invalid endian");et(n!==undefined&&n!==null,"missing offset");et(n+7<e.length,"Trying to write beyond buffer length");Z(t,1.7976931348623157e308,-1.7976931348623157e308)}var s=e.length;if(n>=s)return;h.write(e,t,n,r,52,8)}function j(e){if(e.trim)return e.trim();return e.replace(/^\s+|\s+$/g,"")}function I(e){e._isBuffer=true;e._get=e.get;e._set=e.set;e.get=F.get;e.set=F.set;e.write=F.write;e.toString=F.toString;e.toLocaleString=F.toString;e.toJSON=F.toJSON;e.copy=F.copy;e.slice=F.slice;e.readUInt8=F.readUInt8;e.readUInt16LE=F.readUInt16LE;e.readUInt16BE=F.readUInt16BE;e.readUInt32LE=F.readUInt32LE;e.readUInt32BE=F.readUInt32BE;e.readInt8=F.readInt8;e.readInt16LE=F.readInt16LE;e.readInt16BE=F.readInt16BE;e.readInt32LE=F.readInt32LE;e.readInt32BE=F.readInt32BE;e.readFloatLE=F.readFloatLE;e.readFloatBE=F.readFloatBE;e.readDoubleLE=F.readDoubleLE;e.readDoubleBE=F.readDoubleBE;e.writeUInt8=F.writeUInt8;e.writeUInt16LE=F.writeUInt16LE;e.writeUInt16BE=F.writeUInt16BE;e.writeUInt32LE=F.writeUInt32LE;e.writeUInt32BE=F.writeUInt32BE;e.writeInt8=F.writeInt8;e.writeInt16LE=F.writeInt16LE;e.writeInt16BE=F.writeInt16BE;e.writeInt32LE=F.writeInt32LE;e.writeInt32BE=F.writeInt32BE;e.writeFloatLE=F.writeFloatLE;e.writeFloatBE=F.writeFloatBE;e.writeDoubleLE=F.writeDoubleLE;e.writeDoubleBE=F.writeDoubleBE;e.fill=F.fill;e.inspect=F.inspect;e.toArrayBuffer=F.toArrayBuffer;return e}function q(e,t,n){if(typeof e!=="number")return n;e=~~e;if(e>=t)return t;if(e>=0)return e;e+=t;if(e>=0)return e;return 0}function R(e){e=~~Math.ceil(+e);return e<0?0:e}function U(e){return(Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"})(e)}function z(e){return U(e)||i.isBuffer(e)||e&&typeof e==="object"&&typeof e.length==="number"}function W(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function X(e){var t=[];for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(e.charCodeAt(n));else{var i=n;if(r>=55296&&r<=57343)n++;var s=encodeURIComponent(e.slice(i,n+1)).substr(1).split("%");for(var o=0;o<s.length;o++)t.push(parseInt(s[o],16))}}return t}function V(e){var t=[];for(var n=0;n<e.length;n++){t.push(e.charCodeAt(n)&255)}return t}function $(e){var t,n,r;var i=[];for(var s=0;s<e.length;s++){t=e.charCodeAt(s);n=t>>8;r=t%256;i.push(r);i.push(n)}return i}function J(e){return c.toByteArray(e)}function K(e,t,n,r){var i;for(var s=0;s<r;s++){if(s+n>=t.length||s>=e.length)break;t[s+n]=e[s]}return s}function Q(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}function G(e,t){et(typeof e==="number","cannot write a non-number as a number");et(e>=0,"specified a negative value for writing an unsigned value");et(e<=t,"value is larger than maximum value for type");et(Math.floor(e)===e,"value has a fractional component")}function Y(e,t,n){et(typeof e==="number","cannot write a non-number as a number");et(e<=t,"value larger than maximum allowed value");et(e>=n,"value smaller than minimum allowed value");et(Math.floor(e)===e,"value has a fractional component")}function Z(e,t,n){et(typeof e==="number","cannot write a non-number as a number");et(e<=t,"value larger than maximum allowed value");et(e>=n,"value smaller than minimum allowed value")}function et(e,t){if(!e)throw new Error(t||"Failed assertion")}var c=e("base64-js");var h=e("ieee754");n.Buffer=i;n.SlowBuffer=i;n.INSPECT_MAX_BYTES=50;i.poolSize=8192;i._useTypedArrays=function(){if(typeof Uint8Array!=="function"||typeof ArrayBuffer!=="function")return false;try{var e=new Uint8Array(0);e.foo=function(){return 42};return 42===e.foo()&&typeof e.subarray==="function"}catch(t){return false}}();i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};i.isBuffer=function(e){return!!(e!==null&&e!==undefined&&e._isBuffer)};i.byteLength=function(e,t){var n;e=e+"";switch(t||"utf8"){case"hex":n=e.length/2;break;case"utf8":case"utf-8":n=X(e).length;break;case"ascii":case"binary":case"raw":n=e.length;break;case"base64":n=J(e).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=e.length*2;break;default:throw new Error("Unknown encoding")}return n};i.concat=function(e,t){et(U(e),"Usage: Buffer.concat(list, [totalLength])\n"+"list should be an Array.");if(e.length===0){return new i(0)}else if(e.length===1){return e[0]}var n;if(typeof t!=="number"){t=0;for(n=0;n<e.length;n++){t+=e[n].length}}var r=new i(t);var s=0;for(n=0;n<e.length;n++){var o=e[n];o.copy(r,s);s+=o.length}return r};i.prototype.write=function(e,t,n,r){if(isFinite(t)){if(!isFinite(n)){r=n;n=undefined}}else{var i=r;r=t;t=n;n=i}t=Number(t)||0;var s=this.length-t;if(!n){n=s}else{n=Number(n);if(n>s){n=s}}r=String(r||"utf8").toLowerCase();var o;switch(r){case"hex":o=p(this,e,t,n);break;case"utf8":case"utf-8":o=d(this,e,t,n);break;case"ascii":o=v(this,e,t,n);break;case"binary":o=m(this,e,t,n);break;case"base64":o=g(this,e,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":o=y(this,e,t,n);break;default:throw new Error("Unknown encoding")}return o};i.prototype.toString=function(e,t,n){var r=this;e=String(e||"utf8").toLowerCase();t=Number(t)||0;n=n!==undefined?Number(n):n=r.length;if(n===t)return"";var i;switch(e){case"hex":i=x(r,t,n);break;case"utf8":case"utf-8":i=w(r,t,n);break;case"ascii":i=E(r,t,n);break;case"binary":i=S(r,t,n);break;case"base64":i=b(r,t,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=T(r,t,n);break;default:throw new Error("Unknown encoding")}return i};i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};i.prototype.copy=function(e,t,n,r){var i=this;if(!n)n=0;if(!r&&r!==0)r=this.length;if(!t)t=0;if(r===n)return;if(e.length===0||i.length===0)return;et(r>=n,"sourceEnd < sourceStart");et(t>=0&&t<e.length,"targetStart out of bounds");et(n>=0&&n<i.length,"sourceStart out of bounds");et(r>=0&&r<=i.length,"sourceEnd out of bounds");if(r>this.length)r=this.length;if(e.length-t<r-n)r=e.length-t+n;for(var s=0;s<r-n;s++)e[s+t]=this[s+n]};i.prototype.slice=function(e,t){var n=this.length;e=q(e,n,0);t=q(t,n,n);if(i._useTypedArrays){return I(this.subarray(e,t))}else{var r=t-e;var s=new i(r,undefined,true);for(var o=0;o<r;o++){s[o]=this[o+e]}return s}};i.prototype.get=function(e){console.log(".get() is deprecated. Access using array indexes instead.");return this.readUInt8(e)};i.prototype.set=function(e,t){console.log(".set() is deprecated. Access using array indexes instead.");return this.writeUInt8(e,t)};i.prototype.readUInt8=function(e,t){if(!t){et(e!==undefined&&e!==null,"missing offset");et(e<this.length,"Trying to read beyond buffer length")}if(e>=this.length)return;return this[e]};i.prototype.readUInt16LE=function(e,t){return N(this,e,true,t)};i.prototype.readUInt16BE=function(e,t){return N(this,e,false,t)};i.prototype.readUInt32LE=function(e,t){return C(this,e,true,t)};i.prototype.readUInt32BE=function(e,t){return C(this,e,false,t)};i.prototype.readInt8=function(e,t){if(!t){et(e!==undefined&&e!==null,"missing offset");et(e<this.length,"Trying to read beyond buffer length")}if(e>=this.length)return;var n=this[e]&128;if(n)return(255-this[e]+1)*-1;else return this[e]};i.prototype.readInt16LE=function(e,t){return k(this,e,true,t)};i.prototype.readInt16BE=function(e,t){return k(this,e,false,t)};i.prototype.readInt32LE=function(e,t){return L(this,e,true,t)};i.prototype.readInt32BE=function(e,t){return L(this,e,false,t)};i.prototype.readFloatLE=function(e,t){return A(this,e,true,t)};i.prototype.readFloatBE=function(e,t){return A(this,e,false,t)};i.prototype.readDoubleLE=function(e,t){return O(this,e,true,t)};i.prototype.readDoubleBE=function(e,t){return O(this,e,false,t)};i.prototype.writeUInt8=function(e,t,n){if(!n){et(e!==undefined&&e!==null,"missing value");et(t!==undefined&&t!==null,"missing offset");et(t<this.length,"trying to write beyond buffer length");G(e,255)}if(t>=this.length)return;this[t]=e};i.prototype.writeUInt16LE=function(e,t,n){M(this,e,t,true,n)};i.prototype.writeUInt16BE=function(e,t,n){M(this,e,t,false,n)};i.prototype.writeUInt32LE=function(e,t,n){_(this,e,t,true,n)};i.prototype.writeUInt32BE=function(e,t,n){_(this,e,t,false,n)};i.prototype.writeInt8=function(e,t,n){if(!n){et(e!==undefined&&e!==null,"missing value");et(t!==undefined&&t!==null,"missing offset");et(t<this.length,"Trying to write beyond buffer length");Y(e,127,-128)}if(t>=this.length)return;if(e>=0)this.writeUInt8(e,t,n);else this.writeUInt8(255+e+1,t,n)};i.prototype.writeInt16LE=function(e,t,n){D(this,e,t,true,n)};i.prototype.writeInt16BE=function(e,t,n){D(this,e,t,false,n)};i.prototype.writeInt32LE=function(e,t,n){P(this,e,t,true,n)};i.prototype.writeInt32BE=function(e,t,n){P(this,e,t,false,n)};i.prototype.writeFloatLE=function(e,t,n){H(this,e,t,true,n)};i.prototype.writeFloatBE=function(e,t,n){H(this,e,t,false,n)};i.prototype.writeDoubleLE=function(e,t,n){B(this,e,t,true,n)};i.prototype.writeDoubleBE=function(e,t,n){B(this,e,t,false,n)};i.prototype.fill=function(e,t,n){if(!e)e=0;if(!t)t=0;if(!n)n=this.length;if(typeof e==="string"){e=e.charCodeAt(0)}et(typeof e==="number"&&!isNaN(e),"value is not a number");et(n>=t,"end < start");if(n===t)return;if(this.length===0)return;et(t>=0&&t<this.length,"start out of bounds");et(n>=0&&n<=this.length,"end out of bounds");for(var r=t;r<n;r++){this[r]=e}};i.prototype.inspect=function(){var e=[];var t=this.length;for(var r=0;r<t;r++){e[r]=W(this[r]);if(r===n.INSPECT_MAX_BYTES){e[r+1]="...";break}}return"<Buffer "+e.join(" ")+">"};i.prototype.toArrayBuffer=function(){if(typeof Uint8Array==="function"){if(i._useTypedArrays){return(new i(this)).buffer}else{var e=new Uint8Array(this.length);for(var t=0,n=e.length;t<n;t+=1)e[t]=this[t];return e.buffer}}else{throw new Error("Buffer.toArrayBuffer not supported in this browser")}};var F=i.prototype}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../node_modules/grunt-browserify/node_modules/browserify/node_modules/buffer/index.js","/../node_modules/grunt-browserify/node_modules/browserify/node_modules/buffer")},{"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,"base64-js":2,buffer:1,ieee754:3}],2:[function(e,t,n){(function(e,n,r,i,s,o,u,a,f){var l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";(function(e){"use strict";function f(e){var t=e.charCodeAt(0);if(t===i)return 62;if(t===s)return 63;if(t<o)return-1;if(t<o+10)return t-o+26+26;if(t<a+26)return t-a;if(t<u+26)return t-u+26}function c(e){function c(e){u[l++]=e}var t,r,i,s,o,u;if(e.length%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var a=e.length;o="="===e.charAt(a-2)?2:"="===e.charAt(a-1)?1:0;u=new n(e.length*3/4-o);i=o>0?e.length-4:e.length;var l=0;for(t=0,r=0;t<i;t+=4,r+=3){s=f(e.charAt(t))<<18|f(e.charAt(t+1))<<12|f(e.charAt(t+2))<<6|f(e.charAt(t+3));c((s&16711680)>>16);c((s&65280)>>8);c(s&255)}if(o===2){s=f(e.charAt(t))<<2|f(e.charAt(t+1))>>4;c(s&255)}else if(o===1){s=f(e.charAt(t))<<10|f(e.charAt(t+1))<<4|f(e.charAt(t+2))>>2;c(s>>8&255);c(s&255)}return u}function h(e){function o(e){return l.charAt(e)}function u(e){return o(e>>18&63)+o(e>>12&63)+o(e>>6&63)+o(e&63)}var t,n=e.length%3,r="",i,s;for(t=0,s=e.length-n;t<s;t+=3){i=(e[t]<<16)+(e[t+1]<<8)+e[t+2];r+=u(i)}switch(n){case 1:i=e[e.length-1];r+=o(i>>2);r+=o(i<<4&63);r+="==";break;case 2:i=(e[e.length-2]<<8)+e[e.length-1];r+=o(i>>10);r+=o(i>>4&63);r+=o(i<<2&63);r+="=";break}return r}var n=typeof Uint8Array!=="undefined"?Uint8Array:Array;var r="0".charCodeAt(0);var i="+".charCodeAt(0);var s="/".charCodeAt(0);var o="0".charCodeAt(0);var u="a".charCodeAt(0);var a="A".charCodeAt(0);t.exports.toByteArray=c;t.exports.fromByteArray=h})()}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../node_modules/grunt-browserify/node_modules/browserify/node_modules/buffer/node_modules/base64-js/lib/b64.js","/../node_modules/grunt-browserify/node_modules/browserify/node_modules/buffer/node_modules/base64-js/lib")},{"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],3:[function(e,t,n){(function(e,t,r,i,s,o,u,a,f){n.read=function(e,t,n,r,i){var s,o,u=i*8-r-1,a=(1<<u)-1,f=a>>1,l=-7,c=n?i-1:0,h=n?-1:1,p=e[t+c];c+=h;s=p&(1<<-l)-1;p>>=-l;l+=u;for(;l>0;s=s*256+e[t+c],c+=h,l-=8);o=s&(1<<-l)-1;s>>=-l;l+=r;for(;l>0;o=o*256+e[t+c],c+=h,l-=8);if(s===0){s=1-f}else if(s===a){return o?NaN:(p?-1:1)*Infinity}else{o=o+Math.pow(2,r);s=s-f}return(p?-1:1)*o*Math.pow(2,s-r)};n.write=function(e,t,n,r,i,s){var o,u,a,f=s*8-i-1,l=(1<<f)-1,c=l>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:s-1,d=r?1:-1,v=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){u=isNaN(t)?1:0;o=l}else{o=Math.floor(Math.log(t)/Math.LN2);if(t*(a=Math.pow(2,-o))<1){o--;a*=2}if(o+c>=1){t+=h/a}else{t+=h*Math.pow(2,1-c)}if(t*a>=2){o++;a/=2}if(o+c>=l){u=0;o=l}else if(o+c>=1){u=(t*a-1)*Math.pow(2,i);o=o+c}else{u=t*Math.pow(2,c-1)*Math.pow(2,i);o=0}}for(;i>=8;e[n+p]=u&255,p+=d,u/=256,i-=8);o=o<<i|u;f+=i;for(;f>0;e[n+p]=o&255,p+=d,o/=256,f-=8);e[n+p-d]|=v*128}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../node_modules/grunt-browserify/node_modules/browserify/node_modules/buffer/node_modules/ieee754/index.js","/../node_modules/grunt-browserify/node_modules/browserify/node_modules/buffer/node_modules/ieee754")},{"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],4:[function(e,t,n){(function(e,n,r,i,s,o,u,a,f){function l(){}var e=t.exports={};e.nextTick=function(){var e=typeof window!=="undefined"&&window.setImmediate;var t=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(e){return function(e){return window.setImmediate(e)}}if(t){var n=[];window.addEventListener("message",function(e){var t=e.source;if((t===window||t===null)&&e.data==="process-tick"){e.stopPropagation();if(n.length>0){var r=n.shift();r()}}},true);return function(t){n.push(t);window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}();e.title="browser";e.browser=true;e.env={};e.argv=[];e.on=l;e.once=l;e.off=l;e.emit=l;e.binding=function(e){throw new Error("process.binding is not supported")};e.cwd=function(){return"/"};e.chdir=function(e){throw new Error("process.chdir is not supported")}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js","/../node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process")},{"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],5:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function h(){}var c=e("./Scalar");t.exports=h;h.lineInt=function(e,t,n){n=n||0;var r=[0,0];var i,s,o,u,a,f,l;i=e[1][1]-e[0][1];s=e[0][0]-e[1][0];o=i*e[0][0]+s*e[0][1];u=t[1][1]-t[0][1];a=t[0][0]-t[1][0];f=u*t[0][0]+a*t[0][1];l=i*a-u*s;if(!c.eq(l,0,n)){r[0]=(a*o-s*f)/l;r[1]=(i*f-u*o)/l}return r};h.segmentsIntersect=function(e,t,n,r){var i=t[0]-e[0];var s=t[1]-e[1];var o=r[0]-n[0];var u=r[1]-n[1];if(o*s-u*i==0)return false;var a=(i*(n[1]-e[1])+s*(e[0]-n[0]))/(o*s-u*i);var f=(o*(e[1]-n[1])+u*(n[0]-e[0]))/(u*i-o*s);return a>=0&&a<=1&&f>=0&&f<=1}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../node_modules/poly-decomp/src/Line.js","/../node_modules/poly-decomp/src")},{"./Scalar":8,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],6:[function(e,t,n){(function(e,n,r,i,s,o,u,a,f){function l(){}t.exports=l;l.area=function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])};l.left=function(e,t,n){return l.area(e,t,n)>0};l.leftOn=function(e,t,n){return l.area(e,t,n)>=0};l.right=function(e,t,n){return l.area(e,t,n)<0};l.rightOn=function(e,t,n){return l.area(e,t,n)<=0};var c=[],h=[];l.collinear=function(e,t,n,r){if(!r)return l.area(e,t,n)==0;else{var i=c,s=h;i[0]=t[0]-e[0];i[1]=t[1]-e[1];s[0]=n[0]-t[0];s[1]=n[1]-t[1];var o=i[0]*s[0]+i[1]*s[1],u=Math.sqrt(i[0]*i[0]+i[1]*i[1]),a=Math.sqrt(s[0]*s[0]+s[1]*s[1]),f=Math.acos(o/(u*a));return f<r}};l.sqdist=function(e,t){var n=t[0]-e[0];var r=t[1]-e[1];return n*n+r*r}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../node_modules/poly-decomp/src/Point.js","/../node_modules/poly-decomp/src")},{"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],7:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function d(){this.vertices=[]}function g(e,t,n,r,i){i=i||0;var s=t[1]-e[1];var o=e[0]-t[0];var u=s*e[0]+o*e[1];var a=r[1]-n[1];var f=n[0]-r[0];var l=a*n[0]+f*n[1];var c=s*f-a*o;if(!p.eq(c,0,i))return[(f*u-o*l)/c,(s*l-a*u)/c];else return[0,0]}var c=e("./Line"),h=e("./Point"),p=e("./Scalar");t.exports=d;d.prototype.at=function(e){var t=this.vertices,n=t.length;return t[e<0?e%n+n:e%n]};d.prototype.first=function(){return this.vertices[0]};d.prototype.last=function(){return this.vertices[this.vertices.length-1]};d.prototype.clear=function(){this.vertices.length=0};d.prototype.append=function(e,t,n){if(typeof t=="undefined")throw new Error("From is not given!");if(typeof n=="undefined")throw new Error("To is not given!");if(n-1<t)throw new Error("lol1");if(n>e.vertices.length)throw new Error("lol2");if(t<0)throw new Error("lol3");for(var r=t;r<n;r++){this.vertices.push(e.vertices[r])}};d.prototype.makeCCW=function(){var e=0,t=this.vertices;for(var n=1;n<this.vertices.length;++n){if(t[n][1]<t[e][1]||t[n][1]==t[e][1]&&t[n][0]>t[e][0]){e=n}}if(!h.left(this.at(e-1),this.at(e),this.at(e+1))){this.reverse()}};d.prototype.reverse=function(){var e=[];for(var t=0,n=this.vertices.length;t!==n;t++){e.push(this.vertices.pop())}this.vertices=e};d.prototype.isReflex=function(e){return h.right(this.at(e-1),this.at(e),this.at(e+1))};var v=[],m=[];d.prototype.canSee=function(e,t){var n,r,i=v,s=m;if(h.leftOn(this.at(e+1),this.at(e),this.at(t))&&h.rightOn(this.at(e-1),this.at(e),this.at(t))){return false}r=h.sqdist(this.at(e),this.at(t));for(var o=0;o!==this.vertices.length;++o){if((o+1)%this.vertices.length===e||o===e)continue;if(h.leftOn(this.at(e),this.at(t),this.at(o+1))&&h.rightOn(this.at(e),this.at(t),this.at(o))){i[0]=this.at(e);i[1]=this.at(t);s[0]=this.at(o);s[1]=this.at(o+1);n=c.lineInt(i,s);if(h.sqdist(this.at(e),n)<r){return false}}}return true};d.prototype.copy=function(e,t,n){var r=n||new d;r.clear();if(e<t){for(var i=e;i<=t;i++)r.vertices.push(this.vertices[i])}else{for(var i=0;i<=t;i++)r.vertices.push(this.vertices[i]);for(var i=e;i<this.vertices.length;i++)r.vertices.push(this.vertices[i])}return r};d.prototype.getCutEdges=function(){var e=[],t=[],n=[],r=new d;var i=Number.MAX_VALUE;for(var s=0;s<this.vertices.length;++s){if(this.isReflex(s)){for(var o=0;o<this.vertices.length;++o){if(this.canSee(s,o)){t=this.copy(s,o,r).getCutEdges();n=this.copy(o,s,r).getCutEdges();for(var u=0;u<n.length;u++)t.push(n[u]);if(t.length<i){e=t;i=t.length;e.push([this.at(s),this.at(o)])}}}}}return e};d.prototype.decomp=function(){var e=this.getCutEdges();if(e.length>0)return this.slice(e);else return[this]};d.prototype.slice=function(e){if(e.length==0)return[this];if(e instanceof Array&&e.length&&e[0]instanceof Array&&e[0].length==2&&e[0][0]instanceof Array){var t=[this];for(var n=0;n<e.length;n++){var r=e[n];for(var i=0;i<t.length;i++){var s=t[i];var o=s.slice(r);if(o){t.splice(i,1);t.push(o[0],o[1]);break}}}return t}else{var r=e;var n=this.vertices.indexOf(r[0]);var i=this.vertices.indexOf(r[1]);if(n!=-1&&i!=-1){return[this.copy(n,i),this.copy(i,n)]}else{return false}}};d.prototype.isSimple=function(){var e=this.vertices;for(var t=0;t<e.length-1;t++){for(var n=0;n<t-1;n++){if(c.segmentsIntersect(e[t],e[t+1],e[n],e[n+1])){return false}}}for(var t=1;t<e.length-2;t++){if(c.segmentsIntersect(e[0],e[e.length-1],e[t],e[t+1])){return false}}return true};d.prototype.quickDecomp=function(e,t,n,r,i,s){i=i||100;s=s||0;r=r||25;e=typeof e!="undefined"?e:[];t=t||[];n=n||[];var o=[0,0],u=[0,0],a=[0,0];var f=0,l=0,c=0,p=0;var v=0,m=0,y=0;var b=new d,w=new d;var E=this,S=this.vertices;if(S.length<3)return e;s++;if(s>i){console.warn("quickDecomp: max level ("+i+") reached.");return e}for(var x=0;x<this.vertices.length;++x){if(E.isReflex(x)){t.push(E.vertices[x]);f=l=Number.MAX_VALUE;for(var T=0;T<this.vertices.length;++T){if(h.left(E.at(x-1),E.at(x),E.at(T))&&h.rightOn(E.at(x-1),E.at(x),E.at(T-1))){a=g(E.at(x-1),E.at(x),E.at(T),E.at(T-1));if(h.right(E.at(x+1),E.at(x),a)){c=h.sqdist(E.vertices[x],a);if(c<l){l=c;u=a;m=T}}}if(h.left(E.at(x+1),E.at(x),E.at(T+1))&&h.rightOn(E.at(x+1),E.at(x),E.at(T))){a=g(E.at(x+1),E.at(x),E.at(T),E.at(T+1));if(h.left(E.at(x-1),E.at(x),a)){c=h.sqdist(E.vertices[x],a);if(c<f){f=c;o=a;v=T}}}}if(m==(v+1)%this.vertices.length){a[0]=(u[0]+o[0])/2;a[1]=(u[1]+o[1])/2;n.push(a);if(x<v){b.append(E,x,v+1);b.vertices.push(a);w.vertices.push(a);if(m!=0){w.append(E,m,E.vertices.length)}w.append(E,0,x+1)}else{if(x!=0){b.append(E,x,E.vertices.length)}b.append(E,0,v+1);b.vertices.push(a);w.vertices.push(a);w.append(E,m,x+1)}}else{if(m>v){v+=this.vertices.length}p=Number.MAX_VALUE;if(v<m){return e}for(var T=m;T<=v;++T){if(h.leftOn(E.at(x-1),E.at(x),E.at(T))&&h.rightOn(E.at(x+1),E.at(x),E.at(T))){c=h.sqdist(E.at(x),E.at(T));if(c<p){p=c;y=T%this.vertices.length}}}if(x<y){b.append(E,x,y+1);if(y!=0){w.append(E,y,S.length)}w.append(E,0,x+1)}else{if(x!=0){b.append(E,x,S.length)}b.append(E,0,y+1);w.append(E,y,x+1)}}if(b.vertices.length<w.vertices.length){b.quickDecomp(e,t,n,r,i,s);w.quickDecomp(e,t,n,r,i,s)}else{w.quickDecomp(e,t,n,r,i,s);b.quickDecomp(e,t,n,r,i,s)}return e}}e.push(this);return e};d.prototype.removeCollinearPoints=function(e){var t=0;for(var n=this.vertices.length-1;this.vertices.length>3&&n>=0;--n){if(h.collinear(this.at(n-1),this.at(n),this.at(n+1),e)){this.vertices.splice(n%this.vertices.length,1);n--;t++}}return t}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../node_modules/poly-decomp/src/Polygon.js","/../node_modules/poly-decomp/src")},{"./Line":5,"./Point":6,"./Scalar":8,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],8:[function(e,t,n){(function(e,n,r,i,s,o,u,a,f){function l(){}t.exports=l;l.eq=function(e,t,n){n=n||0;return Math.abs(e-t)<n}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../node_modules/poly-decomp/src/Scalar.js","/../node_modules/poly-decomp/src")},{"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],9:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){t.exports={Polygon:e("./Polygon"),Point:e("./Point")}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/../node_modules/poly-decomp/src/index.js","/../node_modules/poly-decomp/src")},{"./Point":6,"./Polygon":7,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],10:[function(e,t,n){t.exports={name:"p2",version:"0.6.0",description:"A JavaScript 2D physics engine.",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["p2.js","p2","physics","engine","2d"],main:"./src/p2.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/p2.js.git"},bugs:{url:"https://github.com/schteppe/p2.js/issues"},licenses:[{type:"MIT"}],devDependencies:{grunt:"~0.4.0","grunt-contrib-jshint":"~0.9.2","grunt-contrib-nodeunit":"~0.1.2","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.0","grunt-browserify":"~2.0.1","grunt-contrib-concat":"^0.4.0"},dependencies:{"poly-decomp":"0.1.0"}}},{}],11:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e){this.lowerBound=c.create();if(e&&e.lowerBound){c.copy(this.lowerBound,e.lowerBound)}this.upperBound=c.create();if(e&&e.upperBound){c.copy(this.upperBound,e.upperBound)}}var c=e("../math/vec2"),h=e("../utils/Utils");t.exports=p;var d=c.create();p.prototype.setFromPoints=function(e,t,n,r){var i=this.lowerBound,s=this.upperBound;if(typeof n!=="number"){n=0}if(n!==0){c.rotate(i,e[0],n)}else{c.copy(i,e[0])}c.copy(s,i);var o=Math.cos(n),u=Math.sin(n);for(var a=1;a<e.length;a++){var f=e[a];if(n!==0){var l=f[0],h=f[1];d[0]=o*l-u*h;d[1]=u*l+o*h;f=d}for(var p=0;p<2;p++){if(f[p]>s[p]){s[p]=f[p]}if(f[p]<i[p]){i[p]=f[p]}}}if(t){c.add(this.lowerBound,this.lowerBound,t);c.add(this.upperBound,this.upperBound,t)}if(r){this.lowerBound[0]-=r;this.lowerBound[1]-=r;this.upperBound[0]+=r;this.upperBound[1]+=r}};p.prototype.copy=function(e){c.copy(this.lowerBound,e.lowerBound);c.copy(this.upperBound,e.upperBound)};p.prototype.extend=function(e){var t=2;while(t--){var n=e.lowerBound[t];if(this.lowerBound[t]>n){this.lowerBound[t]=n}var r=e.upperBound[t];if(this.upperBound[t]<r){this.upperBound[t]=r}}};p.prototype.overlaps=function(e){var t=this.lowerBound,n=this.upperBound,r=e.lowerBound,i=e.upperBound;return(r[0]<=n[0]&&n[0]<=i[0]||t[0]<=i[0]&&i[0]<=n[0])&&(r[1]<=n[1]&&n[1]<=i[1]||t[1]<=i[1]&&i[1]<=n[1])}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/collision/AABB.js","/collision")},{"../math/vec2":33,"../utils/Utils":52,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],12:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e){this.type=e;this.result=[];this.world=null;this.boundingVolumeType=p.AABB}var c=e("../math/vec2");var h=e("../objects/Body");t.exports=p;p.AABB=1;p.BOUNDING_CIRCLE=2;p.prototype.setWorld=function(e){this.world=e};p.prototype.getCollisionPairs=function(e){throw new Error("getCollisionPairs must be implemented in a subclass!")};var d=c.create();p.boundingRadiusCheck=function(e,t){c.sub(d,e.position,t.position);var n=c.squaredLength(d),r=e.boundingRadius+t.boundingRadius;return n<=r*r};p.aabbCheck=function(e,t){if(e.aabbNeedsUpdate){e.updateAABB()}if(t.aabbNeedsUpdate){t.updateAABB()}return e.aabb.overlaps(t.aabb)};p.prototype.boundingVolumeCheck=function(e,t){var n;switch(this.boundingVolumeType){case p.BOUNDING_CIRCLE:n=p.boundingRadiusCheck(e,t);break;case p.AABB:n=p.aabbCheck(e,t);break;default:throw new Error("Bounding volume type not recognized: "+this.boundingVolumeType)}return n};p.canCollide=function(e,t){if(e.type===h.STATIC&&t.type===h.STATIC){return false}if(e.type===h.KINEMATIC&&t.type===h.STATIC||e.type===h.STATIC&&t.type===h.KINEMATIC){return false}if(e.type===h.KINEMATIC&&t.type===h.KINEMATIC){return false}if(e.sleepState===h.SLEEPING&&t.sleepState===h.SLEEPING){return false}if(e.sleepState===h.SLEEPING&&t.type===h.STATIC||t.sleepState===h.SLEEPING&&e.type===h.STATIC){return false}return true};p.NAIVE=1;p.SAP=2}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/collision/Broadphase.js","/collision")},{"../math/vec2":33,"../objects/Body":34,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],13:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function g(e){d.apply(this);e=m.defaults(e,{xmin:-100,xmax:100,ymin:-100,ymax:100,nx:10,ny:10});this.xmin=e.xmin;this.ymin=e.ymin;this.xmax=e.xmax;this.ymax=e.ymax;this.nx=e.nx;this.ny=e.ny;this.binsizeX=(this.xmax-this.xmin)/this.nx;this.binsizeY=(this.ymax-this.ymin)/this.ny}var c=e("../shapes/Circle"),h=e("../shapes/Plane"),p=e("../shapes/Particle"),d=e("../collision/Broadphase"),v=e("../math/vec2"),m=e("../utils/Utils");t.exports=g;g.prototype=new d;g.prototype.getCollisionPairs=function(e){var t=[],n=e.bodies,r=n.length,i=this.binsizeX,s=this.binsizeY,o=this.nx,u=this.ny,a=this.xmin,f=this.ymin,l=this.xmax,c=this.ymax;var h=[],p=o*u;for(var v=0;v<p;v++){h.push([])}var m=o/(l-a);var g=u/(c-f);for(var v=0;v!==r;v++){var y=n[v];var b=y.aabb;var w=Math.max(b.lowerBound[0],a);var E=Math.max(b.lowerBound[1],f);var S=Math.min(b.upperBound[0],l);var x=Math.min(b.upperBound[1],c);var T=Math.floor(m*(w-a));var N=Math.floor(g*(E-f));var C=Math.floor(m*(S-a));var k=Math.floor(g*(x-f));for(var L=T;L<=C;L++){for(var A=N;A<=k;A++){var O=L;var M=A;var _=O*(u-1)+M;if(_>=0&&_<p){h[_].push(y)}}}}for(var v=0;v!==p;v++){var D=h[v];for(var L=0,P=D.length;L!==P;L++){var y=D[L];for(var A=0;A!==L;A++){var H=D[A];if(d.canCollide(y,H)&&this.boundingVolumeCheck(y,H)){t.push(y,H)}}}}return t}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/collision/GridBroadphase.js","/collision")},{"../collision/Broadphase":12,"../math/vec2":33,"../shapes/Circle":40,"../shapes/Particle":44,"../shapes/Plane":45,"../utils/Utils":52,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],14:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function g(){v.call(this,v.NAIVE)}var c=e("../shapes/Circle"),h=e("../shapes/Plane"),p=e("../shapes/Shape"),d=e("../shapes/Particle"),v=e("../collision/Broadphase"),m=e("../math/vec2");t.exports=g;g.prototype=new v;g.prototype.getCollisionPairs=function(e){var t=e.bodies,n=this.result;n.length=0;for(var r=0,i=t.length;r!==i;r++){var s=t[r];for(var o=0;o<r;o++){var u=t[o];if(v.canCollide(s,u)&&this.boundingVolumeCheck(s,u)){n.push(s,u)}}}return n}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/collision/NaiveBroadphase.js","/collision")},{"../collision/Broadphase":12,"../math/vec2":33,"../shapes/Circle":40,"../shapes/Particle":44,"../shapes/Plane":45,"../shapes/Shape":47,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],15:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function X(){this.contactEquations=[];this.frictionEquations=[];this.enableFriction=true;this.slipForce=10;this.frictionCoefficient=.3;this.surfaceVelocity=0;this.reuseObjects=true;this.reusableContactEquations=[];this.reusableFrictionEquations=[];this.restitution=0;this.stiffness=g.DEFAULT_STIFFNESS;this.relaxation=g.DEFAULT_RELAXATION;this.frictionStiffness=g.DEFAULT_STIFFNESS;this.frictionRelaxation=g.DEFAULT_RELAXATION;this.enableFrictionReduction=true;this.collidingBodiesLastStep=new m;this.contactSkinSize=.01}function V(e,t){c.set(e.vertices[0],-t.length*.5,-t.radius);c.set(e.vertices[1],t.length*.5,-t.radius);c.set(e.vertices[2],t.length*.5,t.radius);c.set(e.vertices[3],-t.length*.5,t.radius)}function nt(e,t,n,r){var i=Y,s=Z,o=et,u=tt,a=e,f=t.vertices,l=null;for(var d=0;d!==f.length+1;d++){var v=f[d%f.length],m=f[(d+1)%f.length];c.rotate(i,v,r);c.rotate(s,m,r);p(i,i,n);p(s,s,n);h(o,i,a);h(u,s,a);var g=c.crossLength(o,u);if(l===null){l=g}if(g*l<=0){return false}l=g}return true}var c=e("../math/vec2"),h=c.sub,p=c.add,d=c.dot,v=e("../utils/Utils"),m=e("../utils/TupleDictionary"),g=e("../equations/Equation"),y=e("../equations/ContactEquation"),b=e("../equations/FrictionEquation"),w=e("../shapes/Circle"),E=e("../shapes/Convex"),S=e("../shapes/Shape"),x=e("../objects/Body"),T=e("../shapes/Rectangle");t.exports=X;var N=c.fromValues(0,1);var C=c.fromValues(0,0),k=c.fromValues(0,0),L=c.fromValues(0,0),A=c.fromValues(0,0),O=c.fromValues(0,0),M=c.fromValues(0,0),_=c.fromValues(0,0),D=c.fromValues(0,0),P=c.fromValues(0,0),H=c.fromValues(0,0),B=c.fromValues(0,0),j=c.fromValues(0,0),F=c.fromValues(0,0),I=c.fromValues(0,0),q=c.fromValues(0,0),R=c.fromValues(0,0),U=c.fromValues(0,0),z=c.fromValues(0,0),W=[];X.prototype.collidedLastStep=function(e,t){var n=e.id|0,r=t.id|0;return!!this.collidingBodiesLastStep.get(n,r)};X.prototype.reset=function(){this.collidingBodiesLastStep.reset();var e=this.contactEquations;var t=e.length;while(t--){var n=e[t],r=n.bodyA.id,i=n.bodyB.id;this.collidingBodiesLastStep.set(r,i,true)}if(this.reuseObjects){var s=this.contactEquations,o=this.frictionEquations,u=this.reusableFrictionEquations,a=this.reusableContactEquations;v.appendArray(a,s);v.appendArray(u,o)}this.contactEquations.length=this.frictionEquations.length=0};X.prototype.createContactEquation=function(e,t,n,r){var i=this.reusableContactEquations.length?this.reusableContactEquations.pop():new y(e,t);i.bodyA=e;i.bodyB=t;i.shapeA=n;i.shapeB=r;i.restitution=this.restitution;i.firstImpact=!this.collidedLastStep(e,t);i.stiffness=this.stiffness;i.relaxation=this.relaxation;i.needsUpdate=true;i.enabled=true;i.offset=this.contactSkinSize;return i};X.prototype.createFrictionEquation=function(e,t,n,r){var i=this.reusableFrictionEquations.length?this.reusableFrictionEquations.pop():new b(e,t);i.bodyA=e;i.bodyB=t;i.shapeA=n;i.shapeB=r;i.setSlipForce(this.slipForce);i.frictionCoefficient=this.frictionCoefficient;i.relativeVelocity=this.surfaceVelocity;i.enabled=true;i.needsUpdate=true;i.stiffness=this.frictionStiffness;i.relaxation=this.frictionRelaxation;i.contactEquations.length=0;return i};X.prototype.createFrictionFromContact=function(e){var t=this.createFrictionEquation(e.bodyA,e.bodyB,e.shapeA,e.shapeB);c.copy(t.contactPointA,e.contactPointA);c.copy(t.contactPointB,e.contactPointB);c.rotate90cw(t.t,e.normalA);t.contactEquations.push(e);return t};X.prototype.createFrictionFromAverage=function(e){if(!e){throw new Error("numContacts == 0!")}var t=this.contactEquations[this.contactEquations.length-1];var n=this.createFrictionEquation(t.bodyA,t.bodyB,t.shapeA,t.shapeB);var r=t.bodyA;var i=t.bodyB;c.set(n.contactPointA,0,0);c.set(n.contactPointB,0,0);c.set(n.t,0,0);for(var s=0;s!==e;s++){t=this.contactEquations[this.contactEquations.length-1-s];if(t.bodyA===r){c.add(n.t,n.t,t.normalA);c.add(n.contactPointA,n.contactPointA,t.contactPointA);c.add(n.contactPointB,n.contactPointB,t.contactPointB)}else{c.sub(n.t,n.t,t.normalA);c.add(n.contactPointA,n.contactPointA,t.contactPointB);c.add(n.contactPointB,n.contactPointB,t.contactPointA)}n.contactEquations.push(t)}var o=1/e;c.scale(n.contactPointA,n.contactPointA,o);c.scale(n.contactPointB,n.contactPointB,o);c.normalize(n.t,n.t);c.rotate90cw(n.t,n.t);return n};X.prototype[S.LINE|S.CONVEX]=X.prototype.convexLine=function(e,t,n,r,i,s,o,u,a){if(a){return false}else{return 0}};X.prototype[S.LINE|S.RECTANGLE]=X.prototype.lineRectangle=function(e,t,n,r,i,s,o,u,a){if(a){return false}else{return 0}};var $=new T(1,1),J=c.create();X.prototype[S.CAPSULE|S.CONVEX]=X.prototype[S.CAPSULE|S.RECTANGLE]=X.prototype.convexCapsule=function(e,t,n,r,i,s,o,u,a){var f=J;c.set(f,s.length/2,0);c.rotate(f,f,u);c.add(f,f,o);var l=this.circleConvex(i,s,f,u,e,t,n,r,a,s.radius);c.set(f,-s.length/2,0);c.rotate(f,f,u);c.add(f,f,o);var h=this.circleConvex(i,s,f,u,e,t,n,r,a,s.radius);if(a&&(l||h)){return true}var p=$;V(p,s);var d=this.convexConvex(e,t,n,r,i,p,o,u,a);return d+l+h};X.prototype[S.CAPSULE|S.LINE]=X.prototype.lineCapsule=function(e,t,n,r,i,s,o,u,a){if(a){return false}else{return 0}};var K=c.create();var Q=c.create();var G=new T(1,1);X.prototype[S.CAPSULE|S.CAPSULE]=X.prototype.capsuleCapsule=function(e,t,n,r,i,s,o,u,a){var f;var l=K,h=Q;var p=0;for(var d=0;d<2;d++){c.set(l,(d===0?-1:1)*t.length/2,0);c.rotate(l,l,r);c.add(l,l,n);for(var v=0;v<2;v++){c.set(h,(v===0?-1:1)*s.length/2,0);c.rotate(h,h,u);c.add(h,h,o);if(this.enableFrictionReduction){f=this.enableFriction;this.enableFriction=false}var m=this.circleCircle(e,t,l,r,i,s,h,u,a,t.radius,s.radius);if(this.enableFrictionReduction){this.enableFriction=f}if(a&&m){return true}p+=m}}if(this.enableFrictionReduction){f=this.enableFriction;this.enableFriction=false}var g=G;V(g,t);var y=this.convexCapsule(e,g,n,r,i,s,o,u,a);if(this.enableFrictionReduction){this.enableFriction=f}if(a&&y){return true}p+=y;if(this.enableFrictionReduction){var f=this.enableFriction;this.enableFriction=false}V(g,s);var b=this.convexCapsule(i,g,o,u,e,t,n,r,a);if(this.enableFrictionReduction){this.enableFriction=f}if(a&&b){return true}p+=b;if(this.enableFrictionReduction){if(p&&this.enableFriction){this.frictionEquations.push(this.createFrictionFromAverage(p))}}return p};X.prototype[S.LINE|S.LINE]=X.prototype.lineLine=function(e,t,n,r,i,s,o,u,a){if(a){return false}else{return 0}};X.prototype[S.PLANE|S.LINE]=X.prototype.planeLine=function(e,t,n,r,i,s,o,u,a){var f=C,l=k,v=L,m=A,g=O,y=M,b=_,w=D,E=P,S=W,x=0;c.set(f,-s.length/2,0);c.set(l,s.length/2,0);c.rotate(v,f,u);c.rotate(m,l,u);p(v,v,o);p(m,m,o);c.copy(f,v);c.copy(l,m);h(g,l,f);c.normalize(y,g);c.rotate90cw(E,y);c.rotate(w,N,r);S[0]=f;S[1]=l;for(var T=0;T<S.length;T++){var H=S[T];h(b,H,n);var B=d(b,w);if(B<0){if(a){return true}var j=this.createContactEquation(e,i,t,s);x++;c.copy(j.normalA,w);c.normalize(j.normalA,j.normalA);c.scale(b,w,B);h(j.contactPointA,H,b);h(j.contactPointA,j.contactPointA,e.position);h(j.contactPointB,H,o);p(j.contactPointB,j.contactPointB,o);h(j.contactPointB,j.contactPointB,i.position);this.contactEquations.push(j);if(!this.enableFrictionReduction){if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(j))}}}}if(a){return false}if(!this.enableFrictionReduction){if(x&&this.enableFriction){this.frictionEquations.push(this.createFrictionFromAverage(x))}}return x};X.prototype[S.PARTICLE|S.CAPSULE]=X.prototype.particleCapsule=function(e,t,n,r,i,s,o,u,a){return this.circleLine(e,t,n,r,i,s,o,u,a,s.radius,0)};X.prototype[S.CIRCLE|S.LINE]=X.prototype.circleLine=function(e,t,n,r,i,s,o,u,a,f,l){var f=f||0,l=typeof l!=="undefined"?l:t.radius,v=C,m=k,g=L,y=A,b=O,w=M,E=_,S=D,x=P,T=H,N=B,q=j,R=F,U=I,z=W;c.set(S,-s.length/2,0);c.set(x,s.length/2,0);c.rotate(T,S,u);c.rotate(N,x,u);p(T,T,o);p(N,N,o);c.copy(S,T);c.copy(x,N);h(w,x,S);c.normalize(E,w);c.rotate90cw(b,E);h(q,n,S);var X=d(q,b);h(y,S,o);h(R,n,o);var V=l+f;if(Math.abs(X)<V){c.scale(v,b,X);h(g,n,v);c.scale(m,b,d(b,R));c.normalize(m,m);c.scale(m,m,f);p(g,g,m);var $=d(E,g);var J=d(E,S);var K=d(E,x);if($>J&&$<K){if(a){return true}var Q=this.createContactEquation(e,i,t,s);c.scale(Q.normalA,v,-1);c.normalize(Q.normalA,Q.normalA);c.scale(Q.contactPointA,Q.normalA,l);p(Q.contactPointA,Q.contactPointA,n);h(Q.contactPointA,Q.contactPointA,e.position);h(Q.contactPointB,g,o);p(Q.contactPointB,Q.contactPointB,o);h(Q.contactPointB,Q.contactPointB,i.position);this.contactEquations.push(Q);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(Q))}return 1}}z[0]=S;z[1]=x;for(var G=0;G<z.length;G++){var Y=z[G];h(q,Y,n);if(c.squaredLength(q)<Math.pow(V,2)){if(a){return true}var Q=this.createContactEquation(e,i,t,s);c.copy(Q.normalA,q);c.normalize(Q.normalA,Q.normalA);c.scale(Q.contactPointA,Q.normalA,l);p(Q.contactPointA,Q.contactPointA,n);h(Q.contactPointA,Q.contactPointA,e.position);h(Q.contactPointB,Y,o);c.scale(U,Q.normalA,-f);p(Q.contactPointB,Q.contactPointB,U);p(Q.contactPointB,Q.contactPointB,o);h(Q.contactPointB,Q.contactPointB,i.position);this.contactEquations.push(Q);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(Q))}return 1}}return 0};X.prototype[S.CIRCLE|S.CAPSULE]=X.prototype.circleCapsule=function(e,t,n,r,i,s,o,u,a){return this.circleLine(e,t,n,r,i,s,o,u,a,s.radius)};X.prototype[S.CIRCLE|S.CONVEX]=X.prototype[S.CIRCLE|S.RECTANGLE]=X.prototype.circleConvex=function(e,t,n,r,i,s,o,u,a,f){var f=typeof f==="number"?f:t.radius;var l=C,d=k,v=L,m=A,g=O,y=M,b=_,w=D,E=P,S=H,x=B,T=-1,N=null,U=j,z=F,W=I,X=q,V=R,$=false,J=Number.MAX_VALUE;var K=0;var Q=s.vertices;for(var G=0;G!==Q.length+1;G++){var Y=Q[G%Q.length],Z=Q[(G+1)%Q.length];c.rotate(l,Y,u);c.rotate(d,Z,u);p(l,l,o);p(d,d,o);h(v,d,l);c.normalize(m,v);c.rotate90cw(g,m);c.scale(W,g,-t.radius);p(W,W,n);if(nt(W,s,o,u)){c.sub(X,l,W);var et=Math.abs(c.dot(X,g));if(et<J){c.copy(V,W);J=et;c.scale(z,g,et);c.add(z,z,W);$=true}}}if($){if(a){return true}var tt=this.createContactEquation(e,i,t,s);c.sub(tt.normalA,V,n);c.normalize(tt.normalA,tt.normalA);c.scale(tt.contactPointA,tt.normalA,f);p(tt.contactPointA,tt.contactPointA,n);h(tt.contactPointA,tt.contactPointA,e.position);h(tt.contactPointB,z,o);p(tt.contactPointB,tt.contactPointB,o);h(tt.contactPointB,tt.contactPointB,i.position);this.contactEquations.push(tt);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(tt))}return 1}if(f>0){for(var G=0;G<Q.length;G++){var rt=Q[G];c.rotate(x,rt,u);p(x,x,o);h(S,x,n);if(c.squaredLength(S)<Math.pow(f,2)){if(a){return true}var tt=this.createContactEquation(e,i,t,s);c.copy(tt.normalA,S);c.normalize(tt.normalA,tt.normalA);c.scale(tt.contactPointA,tt.normalA,f);p(tt.contactPointA,tt.contactPointA,n);h(tt.contactPointA,tt.contactPointA,e.position);h(tt.contactPointB,x,o);p(tt.contactPointB,tt.contactPointB,o);h(tt.contactPointB,tt.contactPointB,i.position);this.contactEquations.push(tt);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(tt))}return 1}}}return 0};var Y=c.create(),Z=c.create(),et=c.create(),tt=c.create();X.prototype[S.PARTICLE|S.CONVEX]=X.prototype[S.PARTICLE|S.RECTANGLE]=X.prototype.particleConvex=function(e,t,n,r,i,s,o,u,a){var f=C,l=k,v=L,m=A,g=O,y=M,b=_,w=D,E=P,S=H,x=B,T=-1,N=null,W=j,X=F,V=I,$=q,J=R,K=U,Q=z,G=Number.MAX_VALUE;var Y=0,Z=false,et=s.vertices;if(!nt(n,s,o,u)){return 0}if(a){return true}var tt=null;for(var rt=0;rt!==et.length+1;rt++){var it=et[rt%et.length],st=et[(rt+1)%et.length];c.rotate(f,it,u);c.rotate(l,st,u);p(f,f,o);p(l,l,o);h(v,l,f);c.normalize(m,v);c.rotate90cw(g,m);h(S,n,f);var ot=d(S,g);h(y,f,o);h(b,n,o);c.sub(K,f,n);var ut=Math.abs(c.dot(K,g));if(ut<G){G=ut;c.scale(X,g,ut);c.add(X,X,n);c.copy(Q,g);Z=true}}if(Z){var at=this.createContactEquation(e,i,t,s);c.scale(at.normalA,Q,-1);c.normalize(at.normalA,at.normalA);c.set(at.contactPointA,0,0);p(at.contactPointA,at.contactPointA,n);h(at.contactPointA,at.contactPointA,e.position);h(at.contactPointB,X,o);p(at.contactPointB,at.contactPointB,o);h(at.contactPointB,at.contactPointB,i.position);this.contactEquations.push(at);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(at))}return 1}return 0};X.prototype[S.CIRCLE]=X.prototype.circleCircle=function(e,t,n,r,i,s,o,u,a,f,l){var d=C,f=f||t.radius,l=l||s.radius;h(d,n,o);var v=f+l;if(c.squaredLength(d)>Math.pow(v,2)){return 0}if(a){return true}var m=this.createContactEquation(e,i,t,s);h(m.normalA,o,n);c.normalize(m.normalA,m.normalA);c.scale(m.contactPointA,m.normalA,f);c.scale(m.contactPointB,m.normalA,-l);p(m.contactPointA,m.contactPointA,n);h(m.contactPointA,m.contactPointA,e.position);p(m.contactPointB,m.contactPointB,o);h(m.contactPointB,m.contactPointB,i.position);this.contactEquations.push(m);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(m))}return 1};X.prototype[S.PLANE|S.CONVEX]=X.prototype[S.PLANE|S.RECTANGLE]=X.prototype.planeConvex=function(e,t,n,r,i,s,o,u,a){var f=C,l=k,v=L;var m=0;c.rotate(l,N,r);for(var g=0;g!==s.vertices.length;g++){var y=s.vertices[g];c.rotate(f,y,u);p(f,f,o);h(v,f,n);if(d(v,l)<=0){if(a){return true}m++;var b=this.createContactEquation(e,i,t,s);h(v,f,n);c.copy(b.normalA,l);var w=d(v,b.normalA);c.scale(v,b.normalA,w);h(b.contactPointB,f,i.position);h(b.contactPointA,f,v);h(b.contactPointA,b.contactPointA,e.position);this.contactEquations.push(b);if(!this.enableFrictionReduction){if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(b))}}}}if(this.enableFrictionReduction){if(this.enableFriction&&m){this.frictionEquations.push(this.createFrictionFromAverage(m))}}return m};X.prototype[S.PARTICLE|S.PLANE]=X.prototype.particlePlane=function(e,t,n,r,i,s,o,u,a){var f=C,l=k;u=u||0;h(f,n,o);c.rotate(l,N,u);var p=d(f,l);if(p>0){return 0}if(a){return true}var v=this.createContactEquation(i,e,s,t);c.copy(v.normalA,l);c.scale(f,v.normalA,p);h(v.contactPointA,n,f);h(v.contactPointA,v.contactPointA,i.position);h(v.contactPointB,n,e.position);this.contactEquations.push(v);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(v))}return 1};X.prototype[S.CIRCLE|S.PARTICLE]=X.prototype.circleParticle=function(e,t,n,r,i,s,o,u,a){var f=C;h(f,o,n);if(c.squaredLength(f)>Math.pow(t.radius,2)){return 0}if(a){return true}var l=this.createContactEquation(e,i,t,s);c.copy(l.normalA,f);c.normalize(l.normalA,l.normalA);c.scale(l.contactPointA,l.normalA,t.radius);p(l.contactPointA,l.contactPointA,n);h(l.contactPointA,l.contactPointA,e.position);h(l.contactPointB,o,i.position);this.contactEquations.push(l);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(l))}return 1};var rt=new w(1),it=c.create(),st=c.create(),ot=c.create();X.prototype[S.PLANE|S.CAPSULE]=X.prototype.planeCapsule=function(e,t,n,r,i,s,o,u,a){var f=it,l=st,h=rt,d=ot;c.set(f,-s.length/2,0);c.rotate(f,f,u);p(f,f,o);c.set(l,s.length/2,0);c.rotate(l,l,u);p(l,l,o);h.radius=s.radius;var v;if(this.enableFrictionReduction){v=this.enableFriction;this.enableFriction=false}var m=this.circlePlane(i,h,f,0,e,t,n,r,a),g=this.circlePlane(i,h,l,0,e,t,n,r,a);if(this.enableFrictionReduction){this.enableFriction=v}if(a){return m||g}else{var y=m+g;if(this.enableFrictionReduction){if(y){this.frictionEquations.push(this.createFrictionFromAverage(y))}}return y}};X.prototype[S.CIRCLE|S.PLANE]=X.prototype.circlePlane=function(e,t,n,r,i,s,o,u,a){var f=e,l=t,v=n,m=i,g=s,y=o,b=u;b=b||0;var w=C,E=k,S=L;h(w,v,y);c.rotate(E,N,b);var x=d(E,w);if(x>l.radius){return 0}if(a){return true}var T=this.createContactEquation(m,f,s,t);c.copy(T.normalA,E);c.scale(T.contactPointB,T.normalA,-l.radius);p(T.contactPointB,T.contactPointB,v);h(T.contactPointB,T.contactPointB,f.position);c.scale(S,T.normalA,x);h(T.contactPointA,w,S);p(T.contactPointA,T.contactPointA,y);h(T.contactPointA,T.contactPointA,m.position);this.contactEquations.push(T);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(T))}return 1};X.prototype[S.CONVEX]=X.prototype[S.CONVEX|S.RECTANGLE]=X.prototype[S.RECTANGLE]=X.prototype.convexConvex=function(e,t,n,r,i,s,o,u,a,f){var l=C,v=k,m=L,g=A,y=O,b=M,w=_,E=D,S=P,x=0,f=typeof f==="number"?f:0;var T=X.findSeparatingAxis(t,n,r,s,o,u,l);if(!T){return 0}h(E,o,n);if(d(l,E)>0){c.scale(l,l,-1)}var N=X.getClosestEdge(t,r,l,true),H=X.getClosestEdge(s,u,l);if(N===-1||H===-1){return 0}for(var B=0;B<2;B++){var j=N,F=H,I=t,q=s,R=n,U=o,z=r,W=u,V=e,$=i;if(B===0){var J;J=j;j=F;F=J;J=I;I=q;q=J;J=R;R=U;U=J;J=z;z=W;W=J;J=V;V=$;$=J}for(var K=F;K<F+2;K++){var Q=q.vertices[(K+q.vertices.length)%q.vertices.length];c.rotate(v,Q,W);p(v,v,U);var G=0;for(var Y=j-1;Y<j+2;Y++){var Z=I.vertices[(Y+I.vertices.length)%I.vertices.length],et=I.vertices[(Y+1+I.vertices.length)%I.vertices.length];c.rotate(m,Z,z);c.rotate(g,et,z);p(m,m,R);p(g,g,R);h(y,g,m);c.rotate90cw(S,y);c.normalize(S,S);h(E,v,m);var tt=d(S,E);if(Y===j&&tt<=f||Y!==j&&tt<=0){G++}}if(G>=3){if(a){return true}var nt=this.createContactEquation(V,$,I,q);x++;var Z=I.vertices[j%I.vertices.length],et=I.vertices[(j+1)%I.vertices.length];c.rotate(m,Z,z);c.rotate(g,et,z);p(m,m,R);p(g,g,R);h(y,g,m);c.rotate90cw(nt.normalA,y);c.normalize(nt.normalA,nt.normalA);h(E,v,m);var tt=d(nt.normalA,E);c.scale(w,nt.normalA,tt);h(nt.contactPointA,v,R);h(nt.contactPointA,nt.contactPointA,w);p(nt.contactPointA,nt.contactPointA,R);h(nt.contactPointA,nt.contactPointA,V.position);h(nt.contactPointB,v,U);p(nt.contactPointB,nt.contactPointB,U);h(nt.contactPointB,nt.contactPointB,$.position);this.contactEquations.push(nt);if(!this.enableFrictionReduction){if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(nt))}}}}}if(this.enableFrictionReduction){if(this.enableFriction&&x){this.frictionEquations.push(this.createFrictionFromAverage(x))}}return x};var ut=c.fromValues(0,0);X.projectConvexOntoAxis=function(e,t,n,r,i){var s=null,o=null,u,a,f=ut;c.rotate(f,r,-n);for(var l=0;l<e.vertices.length;l++){u=e.vertices[l];a=d(u,f);if(s===null||a>s){s=a}if(o===null||a<o){o=a}}if(o>s){var h=o;o=s;s=h}var p=d(t,r);c.set(i,o+p,s+p)};var at=c.fromValues(0,0),ft=c.fromValues(0,0),lt=c.fromValues(0,0),ct=c.fromValues(0,0),ht=c.fromValues(0,0),pt=c.fromValues(0,0);X.findSeparatingAxis=function(e,t,n,r,i,s,o){var u=null,a=false,f=false,l=at,p=ft,d=lt,v=ct,m=ht,g=pt;if(e instanceof T&&r instanceof T){for(var y=0;y!==2;y++){var b=e,w=n;if(y===1){b=r;w=s}for(var E=0;E!==2;E++){if(E===0){c.set(v,0,1)}else if(E===1){c.set(v,1,0)}if(w!==0){c.rotate(v,v,w)}X.projectConvexOntoAxis(e,t,n,v,m);X.projectConvexOntoAxis(r,i,s,v,g);var S=m,x=g,N=false;if(m[0]>g[0]){x=m;S=g;N=true}var C=x[0]-S[1];a=C<=0;if(u===null||C>u){c.copy(o,v);u=C;f=a}}}}else{for(var y=0;y!==2;y++){var b=e,w=n;if(y===1){b=r;w=s}for(var E=0;E!==b.vertices.length;E++){c.rotate(p,b.vertices[E],w);c.rotate(d,b.vertices[(E+1)%b.vertices.length],w);h(l,d,p);c.rotate90cw(v,l);c.normalize(v,v);X.projectConvexOntoAxis(e,t,n,v,m);X.projectConvexOntoAxis(r,i,s,v,g);var S=m,x=g,N=false;if(m[0]>g[0]){x=m;S=g;N=true}var C=x[0]-S[1];a=C<=0;if(u===null||C>u){c.copy(o,v);u=C;f=a}}}}return f};var dt=c.fromValues(0,0),vt=c.fromValues(0,0),mt=c.fromValues(0,0);X.getClosestEdge=function(e,t,n,r){var i=dt,s=vt,o=mt;c.rotate(i,n,-t);if(r){c.scale(i,i,-1)}var u=-1,a=e.vertices.length,f=-1;for(var l=0;l!==a;l++){h(s,e.vertices[(l+1)%a],e.vertices[l%a]);c.rotate90cw(o,s);c.normalize(o,o);var p=d(o,i);if(u===-1||p>f){u=l%a;f=p}}return u};var gt=c.create(),yt=c.create(),bt=c.create(),wt=c.create(),Et=c.create(),St=c.create(),xt=c.create();X.prototype[S.CIRCLE|S.HEIGHTFIELD]=X.prototype.circleHeightfield=function(e,t,n,r,i,s,o,u,a,f){var l=s.data,f=f||t.radius,d=s.elementWidth,v=yt,m=gt,g=Et,y=xt,b=St,w=bt,E=wt;var S=Math.floor((n[0]-f-o[0])/d),x=Math.ceil((n[0]+f-o[0])/d);if(S<0){S=0}if(x>=l.length){x=l.length-1}var T=l[S],N=l[x];for(var C=S;C<x;C++){if(l[C]<N){N=l[C]}if(l[C]>T){T=l[C]}}if(n[1]-f>T){return a?false:0}if(n[1]+f<N){}var k=false;for(var C=S;C<x;C++){c.set(w,C*d,l[C]);c.set(E,(C+1)*d,l[C+1]);c.add(w,w,o);c.add(E,E,o);c.sub(b,E,w);c.rotate(b,b,Math.PI/2);c.normalize(b,b);c.scale(m,b,-f);c.add(m,m,n);c.sub(v,m,w);var L=c.dot(v,b);if(m[0]>=w[0]&&m[0]<E[0]&&L<=0){if(a){return true}k=true;c.scale(v,b,-L);c.add(g,m,v);c.copy(y,b);var A=this.createContactEquation(i,e,s,t);c.copy(A.normalA,y);c.scale(A.contactPointB,A.normalA,-f);p(A.contactPointB,A.contactPointB,n);h(A.contactPointB,A.contactPointB,e.position);c.copy(A.contactPointA,g);c.sub(A.contactPointA,A.contactPointA,i.position);this.contactEquations.push(A);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(A))}}}k=false;if(f>0){for(var C=S;C<=x;C++){c.set(w,C*d,l[C]);c.add(w,w,o);c.sub(v,n,w);if(c.squaredLength(v)<Math.pow(f,2)){if(a){return true}k=true;var A=this.createContactEquation(i,e,s,t);c.copy(A.normalA,v);c.normalize(A.normalA,A.normalA);c.scale(A.contactPointB,A.normalA,-f);p(A.contactPointB,A.contactPointB,n);h(A.contactPointB,A.contactPointB,e.position);h(A.contactPointA,w,o);p(A.contactPointA,A.contactPointA,o);h(A.contactPointA,A.contactPointA,i.position);this.contactEquations.push(A);if(this.enableFriction){this.frictionEquations.push(this.createFrictionFromContact(A))}}}}if(k){return 1}return 0};var Tt=c.create(),Nt=c.create(),Ct=c.create(),kt=new E([c.create(),c.create(),c.create(),c.create()]);X.prototype[S.RECTANGLE|S.HEIGHTFIELD]=X.prototype[S.CONVEX|S.HEIGHTFIELD]=X.prototype.convexHeightfield=function(e,t,n,r,i,s,o,u,a){var f=s.data,l=s.elementWidth,h=Tt,p=Nt,d=Ct,v=kt;var m=Math.floor((e.aabb.lowerBound[0]-o[0])/l),g=Math.ceil((e.aabb.upperBound[0]-o[0])/l);if(m<0){m=0}if(g>=f.length){g=f.length-1}var y=f[m],b=f[g];for(var w=m;w<g;w++){if(f[w]<b){b=f[w]}if(f[w]>y){y=f[w]}}if(e.aabb.lowerBound[1]>y){return a?false:0}var E=false;var S=0;for(var w=m;w<g;w++){c.set(h,w*l,f[w]);c.set(p,(w+1)*l,f[w+1]);c.add(h,h,o);c.add(p,p,o);var x=100;c.set(d,(p[0]+h[0])*.5,(p[1]+h[1]-x)*.5);c.sub(v.vertices[0],p,d);c.sub(v.vertices[1],h,d);c.copy(v.vertices[2],v.vertices[1]);c.copy(v.vertices[3],v.vertices[0]);v.vertices[2][1]-=x;v.vertices[3][1]-=x;S+=this.convexConvex(e,t,n,r,i,v,d,0,a)}return S}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/collision/Narrowphase.js","/collision")},{"../equations/ContactEquation":24,"../equations/Equation":25,"../equations/FrictionEquation":26,"../math/vec2":33,"../objects/Body":34,"../shapes/Circle":40,"../shapes/Convex":41,"../shapes/Rectangle":46,"../shapes/Shape":47,"../utils/TupleDictionary":51,"../utils/Utils":52,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],16:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(){h.call(this,h.SAP);this.axisList=[];this.world=null;this.axisIndex=0;var e=this.axisList;this._addBodyHandler=function(t){e.push(t.body)};this._removeBodyHandler=function(t){var n=e.indexOf(t.body);if(n!==-1){e.splice(n,1)}}}var c=e("../utils/Utils"),h=e("../collision/Broadphase");t.exports=p;p.prototype=new h;p.prototype.setWorld=function(e){this.axisList.length=0;c.appendArray(this.axisList,e.bodies);e.off("addBody",this._addBodyHandler).off("removeBody",this._removeBodyHandler);e.on("addBody",this._addBodyHandler).on("removeBody",this._removeBodyHandler);this.world=e};p.sortAxisList=function(e,t){t=t|0;for(var n=1,r=e.length;n<r;n++){var i=e[n];for(var s=n-1;s>=0;s--){if(e[s].aabb.lowerBound[t]<=i.aabb.lowerBound[t]){break}e[s+1]=e[s]}e[s+1]=i}return e};p.prototype.getCollisionPairs=function(e){var t=this.axisList,n=this.result,r=this.axisIndex;n.length=0;var i=t.length;while(i--){var s=t[i];if(s.aabbNeedsUpdate){s.updateAABB()}}p.sortAxisList(t,r);for(var o=0,u=t.length|0;o!==u;o++){var a=t[o];for(var f=o+1;f<u;f++){var l=t[f];var c=l.aabb.lowerBound[r]<=a.aabb.upperBound[r];if(!c){break}if(h.canCollide(a,l)&&this.boundingVolumeCheck(a,l)){n.push(a,l)}}}return n}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/collision/SAPBroadphase.js","/collision")},{"../collision/Broadphase":12,"../utils/Utils":52,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],17:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function h(e,t,n,r){this.type=n;r=c.defaults(r,{collideConnected:true,wakeUpBodies:true});this.equations=[];this.bodyA=e;this.bodyB=t;this.collideConnected=r.collideConnected;if(r.wakeUpBodies){if(e){e.wakeUp()}if(t){t.wakeUp()}}}t.exports=h;var c=e("../utils/Utils");h.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")};h.DISTANCE=1;h.GEAR=2;h.LOCK=3;h.PRISMATIC=4;h.REVOLUTE=5;h.prototype.setStiffness=function(e){var t=this.equations;for(var n=0;n!==t.length;n++){var r=t[n];r.stiffness=e;r.needsUpdate=true}};h.prototype.setRelaxation=function(e){var t=this.equations;for(var n=0;n!==t.length;n++){var r=t[n];r.relaxation=e;r.needsUpdate=true}}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/constraints/Constraint.js","/constraints")},{"../utils/Utils":52,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],18:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function v(e,t,n){n=d.defaults(n,{localAnchorA:[0,0],localAnchorB:[0,0]});c.call(this,e,t,c.DISTANCE,n);this.localAnchorA=p.fromValues(n.localAnchorA[0],n.localAnchorA[1]);this.localAnchorB=p.fromValues(n.localAnchorB[0],n.localAnchorB[1]);var r=this.localAnchorA;var i=this.localAnchorB;this.distance=0;if(typeof n.distance==="number"){this.distance=n.distance}else{var s=p.create(),o=p.create(),u=p.create();p.rotate(s,r,e.angle);p.rotate(o,i,t.angle);p.add(u,t.position,o);p.sub(u,u,s);p.sub(u,u,e.position);this.distance=p.length(u)}var a;if(typeof n.maxForce==="undefined"){a=Number.MAX_VALUE}else{a=n.maxForce}var f=new h(e,t,-a,a);this.equations=[f];this.maxForce=a;var u=p.create();var l=p.create();var v=p.create();var m=this;f.computeGq=function(){var e=this.bodyA,t=this.bodyB,n=e.position,s=t.position;p.rotate(l,r,e.angle);p.rotate(v,i,t.angle);p.add(u,s,v);p.sub(u,u,l);p.sub(u,u,n);return p.length(u)-m.distance};this.setMaxForce(a);this.upperLimitEnabled=false;this.upperLimit=1;this.lowerLimitEnabled=false;this.lowerLimit=0;this.position=0}var c=e("./Constraint"),h=e("../equations/Equation"),p=e("../math/vec2"),d=e("../utils/Utils");t.exports=v;v.prototype=new c;var m=p.create();var g=p.create();var y=p.create();v.prototype.update=function(){var e=this.equations[0],t=this.bodyA,n=this.bodyB,r=this.distance,i=t.position,s=n.position,o=this.equations[0],u=e.G;p.rotate(g,this.localAnchorA,t.angle);p.rotate(y,this.localAnchorB,n.angle);p.add(m,s,y);p.sub(m,m,g);p.sub(m,m,i);this.position=p.length(m);var a=false;if(this.upperLimitEnabled){if(this.position>this.upperLimit){o.maxForce=0;o.minForce=-this.maxForce;this.distance=this.upperLimit;a=true}}if(this.lowerLimitEnabled){if(this.position<this.lowerLimit){o.maxForce=this.maxForce;o.minForce=0;this.distance=this.lowerLimit;a=true}}if((this.lowerLimitEnabled||this.upperLimitEnabled)&&!a){o.enabled=false;return}o.enabled=true;p.normalize(m,m);var f=p.crossLength(g,m),l=p.crossLength(y,m);u[0]=-m[0];u[1]=-m[1];u[2]=-f;u[3]=m[0];u[4]=m[1];u[5]=l};v.prototype.setMaxForce=function(e){var t=this.equations[0];t.minForce=-e;t.maxForce=e};v.prototype.getMaxForce=function(e){var t=this.equations[0];return t.maxForce}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/constraints/DistanceConstraint.js","/constraints")},{"../equations/Equation":25,"../math/vec2":33,"../utils/Utils":52,"./Constraint":17,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],19:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function v(e,t,n){n=n||{};c.call(this,e,t,c.GEAR,n);this.ratio=typeof n.ratio==="number"?n.ratio:1;this.angle=typeof n.angle==="number"?n.angle:t.angle-this.ratio*e.angle;n.angle=this.angle;n.ratio=this.ratio;this.equations=[new p(e,t,n)];if(typeof n.maxTorque==="number"){this.setMaxTorque(n.maxTorque)}}var c=e("./Constraint"),h=e("../equations/Equation"),p=e("../equations/AngleLockEquation"),d=e("../math/vec2");t.exports=v;v.prototype=new c;v.prototype.update=function(){var e=this.equations[0];if(e.ratio!==this.ratio){e.setRatio(this.ratio)}e.angle=this.angle};v.prototype.setMaxTorque=function(e){this.equations[0].setMaxTorque(e)};v.prototype.getMaxTorque=function(e){return this.equations[0].maxForce}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/constraints/GearConstraint.js","/constraints")},{"../equations/AngleLockEquation":23,"../equations/Equation":25,"../math/vec2":33,"./Constraint":17,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],20:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function d(e,t,n){n=n||{};c.call(this,e,t,c.LOCK,n);var r=typeof n.maxForce==="undefined"?Number.MAX_VALUE:n.maxForce;var i=n.localAngleB||0;var s=new p(e,t,-r,r),o=new p(e,t,-r,r),u=new p(e,t,-r,r);var a=h.create(),f=h.create(),l=this;s.computeGq=function(){h.rotate(a,l.localOffsetB,e.angle);h.sub(f,t.position,e.position);h.sub(f,f,a);return f[0]};o.computeGq=function(){h.rotate(a,l.localOffsetB,e.angle);h.sub(f,t.position,e.position);h.sub(f,f,a);return f[1]};var d=h.create(),v=h.create();u.computeGq=function(){h.rotate(d,l.localOffsetB,t.angle-l.localAngleB);h.scale(d,d,-1);h.sub(f,e.position,t.position);h.add(f,f,d);h.rotate(v,d,-Math.PI/2);h.normalize(v,v);return h.dot(f,v)};this.localOffsetB=h.create();if(n.localOffsetB){h.copy(this.localOffsetB,n.localOffsetB)}else{h.sub(this.localOffsetB,t.position,e.position);h.rotate(this.localOffsetB,this.localOffsetB,-e.angle)}this.localAngleB=0;if(typeof n.localAngleB==="number"){this.localAngleB=n.localAngleB}else{this.localAngleB=t.angle-e.angle}this.equations.push(s,o,u);this.setMaxForce(r)}var c=e("./Constraint"),h=e("../math/vec2"),p=e("../equations/Equation");t.exports=d;d.prototype=new c;d.prototype.setMaxForce=function(e){var t=this.equations;for(var n=0;n<this.equations.length;n++){t[n].maxForce=e;t[n].minForce=-e}};d.prototype.getMaxForce=function(){return this.equations[0].maxForce};var v=h.create();var m=h.create();var g=h.create();var y=h.fromValues(1,0);var b=h.fromValues(0,1);d.prototype.update=function(){var e=this.equations[0],t=this.equations[1],n=this.equations[2],r=this.bodyA,i=this.bodyB;h.rotate(v,this.localOffsetB,r.angle);h.rotate(m,this.localOffsetB,i.angle-this.localAngleB);h.scale(m,m,-1);h.rotate(g,m,Math.PI/2);h.normalize(g,g);e.G[0]=-1;e.G[1]=0;e.G[2]=-h.crossLength(v,y);e.G[3]=1;t.G[0]=0;t.G[1]=-1;t.G[2]=-h.crossLength(v,b);t.G[4]=1;n.G[0]=-g[0];n.G[1]=-g[1];n.G[3]=g[0];n.G[4]=g[1];n.G[5]=h.crossLength(m,g)}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/constraints/LockConstraint.js","/constraints")},{"../equations/Equation":25,"../math/vec2":33,"./Constraint":17,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],21:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function m(e,t,n){n=n||{};c.call(this,e,t,c.PRISMATIC,n);var r=d.fromValues(0,0),i=d.fromValues(1,0),s=d.fromValues(0,0);if(n.localAnchorA){d.copy(r,n.localAnchorA)}if(n.localAxisA){d.copy(i,n.localAxisA)}if(n.localAnchorB){d.copy(s,n.localAnchorB)}this.localAnchorA=r;this.localAnchorB=s;this.localAxisA=i;var o=this.maxForce=typeof n.maxForce!=="undefined"?n.maxForce:Number.MAX_VALUE;var u=new p(e,t,-o,o);var a=new d.create,f=new d.create,l=new d.create,m=new d.create;u.computeGq=function(){return d.dot(l,m)};u.updateJacobian=function(){var n=this.G,o=e.position,u=t.position;d.rotate(a,r,e.angle);d.rotate(f,s,t.angle);d.add(l,u,f);d.sub(l,l,o);d.sub(l,l,a);d.rotate(m,i,e.angle+Math.PI/2);n[0]=-m[0];n[1]=-m[1];n[2]=-d.crossLength(a,m)+d.crossLength(m,l);n[3]=m[0];n[4]=m[1];n[5]=d.crossLength(f,m)};this.equations.push(u);if(!n.disableRotationalLock){var g=new v(e,t,-o,o);this.equations.push(g)}this.position=0;this.velocity=0;this.lowerLimitEnabled=typeof n.lowerLimit!=="undefined"?true:false;this.upperLimitEnabled=typeof n.upperLimit!=="undefined"?true:false;this.lowerLimit=typeof n.lowerLimit!=="undefined"?n.lowerLimit:0;this.upperLimit=typeof n.upperLimit!=="undefined"?n.upperLimit:1;this.upperLimitEquation=new h(e,t);this.lowerLimitEquation=new h(e,t);this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0;this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=o;this.motorEquation=new p(e,t);this.motorEnabled=false;this.motorSpeed=0;var y=this;var b=this.motorEquation;var w=b.computeGW;b.computeGq=function(){return 0};b.computeGW=function(){var e=this.G,t=this.bodyA,n=this.bodyB,r=t.velocity,i=n.velocity,s=t.angularVelocity,o=n.angularVelocity;return this.gmult(e,r,s,i,o)+y.motorSpeed}}var c=e("./Constraint"),h=e("../equations/ContactEquation"),p=e("../equations/Equation"),d=e("../math/vec2"),v=e("../equations/RotationalLockEquation");t.exports=m;m.prototype=new c;var g=d.create(),y=d.create(),b=d.create(),w=d.create(),E=d.create(),S=d.create();m.prototype.update=function(){var e=this.equations,t=e[0],n=this.upperLimit,r=this.lowerLimit,i=this.upperLimitEquation,s=this.lowerLimitEquation,o=this.bodyA,u=this.bodyB,a=this.localAxisA,f=this.localAnchorA,l=this.localAnchorB;t.updateJacobian();d.rotate(g,a,o.angle);d.rotate(w,f,o.angle);d.add(y,w,o.position);d.rotate(E,l,u.angle);d.add(b,E,u.position);var c=this.position=d.dot(b,g)-d.dot(y,g);if(this.motorEnabled){var h=this.motorEquation.G;h[0]=g[0];h[1]=g[1];h[2]=d.crossLength(g,E);h[3]=-g[0];h[4]=-g[1];h[5]=-d.crossLength(g,w)}if(this.upperLimitEnabled&&c>n){d.scale(i.normalA,g,-1);d.sub(i.contactPointA,y,o.position);d.sub(i.contactPointB,b,u.position);d.scale(S,g,n);d.add(i.contactPointA,i.contactPointA,S);if(e.indexOf(i)===-1){e.push(i)}}else{var p=e.indexOf(i);if(p!==-1){e.splice(p,1)}}if(this.lowerLimitEnabled&&c<r){d.scale(s.normalA,g,1);d.sub(s.contactPointA,y,o.position);d.sub(s.contactPointB,b,u.position);d.scale(S,g,r);d.sub(s.contactPointB,s.contactPointB,S);if(e.indexOf(s)===-1){e.push(s)}}else{var p=e.indexOf(s);if(p!==-1){e.splice(p,1)}}};m.prototype.enableMotor=function(){if(this.motorEnabled){return}this.equations.push(this.motorEquation);this.motorEnabled=true};m.prototype.disableMotor=function(){if(!this.motorEnabled){return}var e=this.equations.indexOf(this.motorEquation);this.equations.splice(e,1);this.motorEnabled=false};m.prototype.setLimits=function(e,t){if(typeof e==="number"){this.lowerLimit=e;this.lowerLimitEnabled=true}else{this.lowerLimit=e;this.lowerLimitEnabled=false}if(typeof t==="number"){this.upperLimit=t;this.upperLimitEnabled=true}else{this.upperLimit=t;this.upperLimitEnabled=false}}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/constraints/PrismaticConstraint.js","/constraints")},{"../equations/ContactEquation":24,"../equations/Equation":25,"../equations/RotationalLockEquation":27,"../math/vec2":33,"./Constraint":17,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],22:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function E(e,t,n){n=n||{};c.call(this,e,t,c.REVOLUTE,n);var r=this.maxForce=typeof n.maxForce!=="undefined"?n.maxForce:Number.MAX_VALUE;this.pivotA=v.create();this.pivotB=v.create();if(n.worldPivot){v.sub(this.pivotA,n.worldPivot,e.position);v.sub(this.pivotB,n.worldPivot,t.position);v.rotate(this.pivotA,this.pivotA,-e.angle);v.rotate(this.pivotB,this.pivotB,-t.angle)}else{v.copy(this.pivotA,n.localPivotA);v.copy(this.pivotB,n.localPivotB)}var i=this.equations=[new h(e,t,-r,r),new h(e,t,-r,r)];var s=i[0];var o=i[1];var u=this;s.computeGq=function(){v.rotate(m,u.pivotA,e.angle);v.rotate(g,u.pivotB,t.angle);v.add(w,t.position,g);v.sub(w,w,e.position);v.sub(w,w,m);return v.dot(w,y)};o.computeGq=function(){v.rotate(m,u.pivotA,e.angle);v.rotate(g,u.pivotB,t.angle);v.add(w,t.position,g);v.sub(w,w,e.position);v.sub(w,w,m);return v.dot(w,b)};o.minForce=s.minForce=-r;o.maxForce=s.maxForce=r;this.motorEquation=new p(e,t);this.motorEnabled=false;this.angle=0;this.lowerLimitEnabled=false;this.upperLimitEnabled=false;this.lowerLimit=0;this.upperLimit=0;this.upperLimitEquation=new d(e,t);this.lowerLimitEquation=new d(e,t);this.upperLimitEquation.minForce=0;this.lowerLimitEquation.maxForce=0}var c=e("./Constraint"),h=e("../equations/Equation"),p=e("../equations/RotationalVelocityEquation"),d=e("../equations/RotationalLockEquation"),v=e("../math/vec2");t.exports=E;var m=v.create(),g=v.create(),y=v.fromValues(1,0),b=v.fromValues(0,1),w=v.create();E.prototype=new c;E.prototype.setLimits=function(e,t){if(typeof e==="number"){this.lowerLimit=e;this.lowerLimitEnabled=true}else{this.lowerLimit=e;this.lowerLimitEnabled=false}if(typeof t==="number"){this.upperLimit=t;this.upperLimitEnabled=true}else{this.upperLimit=t;this.upperLimitEnabled=false}};E.prototype.update=function(){var e=this.bodyA,t=this.bodyB,n=this.pivotA,r=this.pivotB,i=this.equations,s=i[0],o=i[1],u=i[0],a=i[1],f=this.upperLimit,l=this.lowerLimit,c=this.upperLimitEquation,h=this.lowerLimitEquation;var p=this.angle=t.angle-e.angle;if(this.upperLimitEnabled&&p>f){c.angle=f;if(i.indexOf(c)===-1){i.push(c)}}else{var d=i.indexOf(c);if(d!==-1){i.splice(d,1)}}if(this.lowerLimitEnabled&&p<l){h.angle=l;if(i.indexOf(h)===-1){i.push(h)}}else{var d=i.indexOf(h);if(d!==-1){i.splice(d,1)}}v.rotate(m,n,e.angle);v.rotate(g,r,t.angle);u.G[0]=-1;u.G[1]=0;u.G[2]=-v.crossLength(m,y);u.G[3]=1;u.G[4]=0;u.G[5]=v.crossLength(g,y);a.G[0]=0;a.G[1]=-1;a.G[2]=-v.crossLength(m,b);a.G[3]=0;a.G[4]=1;a.G[5]=v.crossLength(g,b)};E.prototype.enableMotor=function(){if(this.motorEnabled){return}this.equations.push(this.motorEquation);this.motorEnabled=true};E.prototype.disableMotor=function(){if(!this.motorEnabled){return}var e=this.equations.indexOf(this.motorEquation);this.equations.splice(e,1);this.motorEnabled=false};E.prototype.motorIsEnabled=function(){return!!this.motorEnabled};E.prototype.setMotorSpeed=function(e){if(!this.motorEnabled){return}var t=this.equations.indexOf(this.motorEquation);this.equations[t].relativeVelocity=e};E.prototype.getMotorSpeed=function(){if(!this.motorEnabled){return false}return this.motorEquation.relativeVelocity}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/constraints/RevoluteConstraint.js","/constraints")},{"../equations/Equation":25,"../equations/RotationalLockEquation":27,"../equations/RotationalVelocityEquation":28,"../math/vec2":33,"./Constraint":17,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],23:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e,t,n){n=n||{};c.call(this,e,t,-Number.MAX_VALUE,Number.MAX_VALUE);this.angle=n.angle||0;this.ratio=typeof n.ratio==="number"?n.ratio:1;this.setRatio(this.ratio)}var c=e("./Equation"),h=e("../math/vec2");t.exports=p;p.prototype=new c;p.prototype.constructor=p;p.prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle};p.prototype.setRatio=function(e){var t=this.G;t[2]=e;t[5]=-1;this.ratio=e};p.prototype.setMaxTorque=function(e){this.maxForce=e;this.minForce=-e}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/equations/AngleLockEquation.js","/equations")},{"../math/vec2":33,"./Equation":25,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],24:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e,t){c.call(this,e,t,0,Number.MAX_VALUE);this.contactPointA=h.create();this.penetrationVec=h.create();this.contactPointB=h.create();this.normalA=h.create();this.restitution=0;this.firstImpact=false;this.shapeA=null;this.shapeB=null}var c=e("./Equation"),h=e("../math/vec2");t.exports=p;p.prototype=new c;p.prototype.constructor=p;p.prototype.computeB=function(e,t,n){var r=this.bodyA,i=this.bodyB,s=this.contactPointA,o=this.contactPointB,u=r.position,a=i.position;var f=this.penetrationVec,l=this.normalA,c=this.G;var p=h.crossLength(s,l),d=h.crossLength(o,l);c[0]=-l[0];c[1]=-l[1];c[2]=-p;c[3]=l[0];c[4]=l[1];c[5]=d;h.add(f,a,o);h.sub(f,f,u);h.sub(f,f,s);var v,m;if(this.firstImpact&&this.restitution!==0){m=0;v=1/t*(1+this.restitution)*this.computeGW()}else{m=h.dot(l,f)+this.offset;v=this.computeGW()}var g=this.computeGiMf();var y=-m*e-v*t-n*g;return y}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/equations/ContactEquation.js","/equations")},{"../math/vec2":33,"./Equation":25,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],25:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function d(e,t,n,r){this.minForce=typeof n==="undefined"?-Number.MAX_VALUE:n;this.maxForce=typeof r==="undefined"?Number.MAX_VALUE:r;this.bodyA=e;this.bodyB=t;this.stiffness=d.DEFAULT_STIFFNESS;this.relaxation=d.DEFAULT_RELAXATION;this.G=new h.ARRAY_TYPE(6);for(var i=0;i<6;i++){this.G[i]=0}this.offset=0;this.a=0;this.b=0;this.epsilon=0;this.timeStep=1/60;this.needsUpdate=true;this.multiplier=0;this.relativeVelocity=0;this.enabled=true}t.exports=d;var c=e("../math/vec2"),h=e("../utils/Utils"),p=e("../objects/Body");d.prototype.constructor=d;d.DEFAULT_STIFFNESS=1e6;d.DEFAULT_RELAXATION=4;d.prototype.update=function(){var e=this.stiffness,t=this.relaxation,n=this.timeStep;this.a=4/(n*(1+4*t));this.b=4*t/(1+4*t);this.epsilon=4/(n*n*e*(1+4*t));this.needsUpdate=false};d.prototype.gmult=function(e,t,n,r,i){return e[0]*t[0]+e[1]*t[1]+e[2]*n+e[3]*r[0]+e[4]*r[1]+e[5]*i};d.prototype.computeB=function(e,t,n){var r=this.computeGW();var i=this.computeGq();var s=this.computeGiMf();return-i*e-r*t-s*n};var v=c.create(),m=c.create();d.prototype.computeGq=function(){var e=this.G,t=this.bodyA,n=this.bodyB,r=t.position,i=n.position,s=t.angle,o=n.angle;return this.gmult(e,v,s,m,o)+this.offset};d.prototype.computeGW=function(){var e=this.G,t=this.bodyA,n=this.bodyB,r=t.velocity,i=n.velocity,s=t.angularVelocity,o=n.angularVelocity;return this.gmult(e,r,s,i,o)+this.relativeVelocity};d.prototype.computeGWlambda=function(){var e=this.G,t=this.bodyA,n=this.bodyB,r=t.vlambda,i=n.vlambda,s=t.wlambda,o=n.wlambda;return this.gmult(e,r,s,i,o)};var g=c.create(),y=c.create();d.prototype.computeGiMf=function(){var e=this.bodyA,t=this.bodyB,n=e.force,r=e.angularForce,i=t.force,s=t.angularForce,o=e.invMassSolve,u=t.invMassSolve,a=e.invInertiaSolve,f=t.invInertiaSolve,l=this.G;c.scale(g,n,o);c.scale(y,i,u);return this.gmult(l,g,r*a,y,s*f)};d.prototype.computeGiMGt=function(){var e=this.bodyA,t=this.bodyB,n=e.invMassSolve,r=t.invMassSolve,i=e.invInertiaSolve,s=t.invInertiaSolve,o=this.G;return o[0]*o[0]*n+o[1]*o[1]*n+o[2]*o[2]*i+o[3]*o[3]*r+o[4]*o[4]*r+o[5]*o[5]*s};var b=c.create(),w=c.create(),E=c.create(),S=c.create(),x=c.create(),T=c.create();d.prototype.addToWlambda=function(e){var t=this.bodyA,n=this.bodyB,r=b,i=w,s=E,o=S,u=x,a=t.invMassSolve,f=n.invMassSolve,l=t.invInertiaSolve,h=n.invInertiaSolve,p=T,d=this.G;i[0]=d[0];i[1]=d[1];s[0]=d[3];s[1]=d[4];c.scale(r,i,a*e);c.add(t.vlambda,t.vlambda,r);t.wlambda+=l*d[2]*e;c.scale(r,s,f*e);c.add(n.vlambda,n.vlambda,r);n.wlambda+=h*d[5]*e};d.prototype.computeInvC=function(e){return 1/(this.computeGiMGt()+e)}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/equations/Equation.js","/equations")},{"../math/vec2":33,"../objects/Body":34,"../utils/Utils":52,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],26:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function d(e,t,n){h.call(this,e,t,-n,n);this.contactPointA=c.create();this.contactPointB=c.create();this.t=c.create();this.contactEquations=[];this.shapeA=null;this.shapeB=null;this.frictionCoefficient=.3}var c=e("../math/vec2"),h=e("./Equation"),p=e("../utils/Utils");t.exports=d;d.prototype=new h;d.prototype.constructor=d;d.prototype.setSlipForce=function(e){this.maxForce=e;this.minForce=-e};d.prototype.getSlipForce=function(){return this.maxForce};d.prototype.computeB=function(e,t,n){var r=this.bodyA,i=this.bodyB,s=this.contactPointA,o=this.contactPointB,u=this.t,a=this.G;a[0]=-u[0];a[1]=-u[1];a[2]=-c.crossLength(s,u);a[3]=u[0];a[4]=u[1];a[5]=c.crossLength(o,u);var f=this.computeGW(),l=this.computeGiMf();var h=-f*t-n*l;return h}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/equations/FrictionEquation.js","/equations")},{"../math/vec2":33,"../utils/Utils":52,"./Equation":25,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],27:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e,t,n){n=n||{};c.call(this,e,t,-Number.MAX_VALUE,Number.MAX_VALUE);this.angle=n.angle||0;var r=this.G;r[2]=1;r[5]=-1}var c=e("./Equation"),h=e("../math/vec2");t.exports=p;p.prototype=new c;p.prototype.constructor=p;var d=h.create(),v=h.create(),m=h.fromValues(1,0),g=h.fromValues(0,1);p.prototype.computeGq=function(){h.rotate(d,m,this.bodyA.angle+this.angle);h.rotate(v,g,this.bodyB.angle);return h.dot(d,v)}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/equations/RotationalLockEquation.js","/equations")},{"../math/vec2":33,"./Equation":25,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],28:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e,t){c.call(this,e,t,-Number.MAX_VALUE,Number.MAX_VALUE);this.relativeVelocity=1;this.ratio=1}var c=e("./Equation"),h=e("../math/vec2");t.exports=p;p.prototype=new c;p.prototype.constructor=p;p.prototype.computeB=function(e,t,n){var r=this.G;r[2]=-1;r[5]=this.ratio;var i=this.computeGiMf();var s=this.computeGW();var o=-s*t-n*i;return o}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/equations/RotationalVelocityEquation.js","/equations")},{"../math/vec2":33,"./Equation":25,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],29:[function(e,t,n){(function(e,n,r,i,s,o,u,a,f){var l=function(){};t.exports=l;l.prototype={constructor:l,on:function(e,t,n){t.context=n||this;if(this._listeners===undefined){this._listeners={}}var r=this._listeners;if(r[e]===undefined){r[e]=[]}if(r[e].indexOf(t)===-1){r[e].push(t)}return this},has:function(e,t){if(this._listeners===undefined){return false}var n=this._listeners;if(t){if(n[e]!==undefined&&n[e].indexOf(t)!==-1){return true}}else{if(n[e]!==undefined){return true}}return false},off:function(e,t){if(this._listeners===undefined){return this}var n=this._listeners;var r=n[e].indexOf(t);if(r!==-1){n[e].splice(r,1)}return this},emit:function(e){if(this._listeners===undefined){return this}var t=this._listeners;var n=t[e.type];if(n!==undefined){e.target=this;for(var r=0,i=n.length;r<i;r++){var s=n[r];s.call(s.context,e)}}return this}}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/events/EventEmitter.js","/events")},{"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],30:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e,t,n){n=n||{};if(!(e instanceof c)||!(t instanceof c)){throw new Error("First two arguments must be Material instances.")}this.id=p.idCounter++;this.materialA=e;this.materialB=t;this.friction=typeof n.friction!=="undefined"?Number(n.friction):.3;this.restitution=typeof n.restitution!=="undefined"?Number(n.restitution):0;this.stiffness=typeof n.stiffness!=="undefined"?Number(n.stiffness):h.DEFAULT_STIFFNESS;this.relaxation=typeof n.relaxation!=="undefined"?Number(n.relaxation):h.DEFAULT_RELAXATION;this.frictionStiffness=typeof n.frictionStiffness!=="undefined"?Number(n.frictionStiffness):h.DEFAULT_STIFFNESS;this.frictionRelaxation=typeof n.frictionRelaxation!=="undefined"?Number(n.frictionRelaxation):h.DEFAULT_RELAXATION;this.surfaceVelocity=typeof n.surfaceVelocity!=="undefined"?Number(n.surfaceVelocity):0;this.contactSkinSize=.005}var c=e("./Material");var h=e("../equations/Equation");t.exports=p;p.idCounter=0}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/material/ContactMaterial.js","/material")},{"../equations/Equation":25,"./Material":31,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],31:[function(e,t,n){(function(e,n,r,i,s,o,u,a,f){function l(e){this.id=e||l.idCounter++}t.exports=l;l.idCounter=0}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/material/Material.js","/material")},{"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],32:[function(e,t,n){(function(e,n,r,i,s,o,u,a,f){var l={};l.GetArea=function(e){if(e.length<6)return 0;var t=e.length-2;var n=0;for(var r=0;r<t;r+=2)n+=(e[r+2]-e[r])*(e[r+1]+e[r+3]);n+=(e[0]-e[t])*(e[t+1]+e[1]);return-n*.5};l.Triangulate=function(e){var t=e.length>>1;if(t<3)return[];var n=[];var r=[];for(var i=0;i<t;i++)r.push(i);var i=0;var s=t;while(s>3){var o=r[(i+0)%s];var u=r[(i+1)%s];var a=r[(i+2)%s];var f=e[2*o],c=e[2*o+1];var h=e[2*u],p=e[2*u+1];var d=e[2*a],v=e[2*a+1];var m=false;if(l._convex(f,c,h,p,d,v)){m=true;for(var g=0;g<s;g++){var y=r[g];if(y==o||y==u||y==a)continue;if(l._PointInTriangle(e[2*y],e[2*y+1],f,c,h,p,d,v)){m=false;break}}}if(m){n.push(o,u,a);r.splice((i+1)%s,1);s--;i=0}else if(i++>3*s)break}n.push(r[0],r[1],r[2]);return n};l._PointInTriangle=function(e,t,n,r,i,s,o,u){var a=o-n;var f=u-r;var l=i-n;var c=s-r;var h=e-n;var p=t-r;var d=a*a+f*f;var v=a*l+f*c;var m=a*h+f*p;var g=l*l+c*c;var y=l*h+c*p;var b=1/(d*g-v*v);var w=(g*m-v*y)*b;var E=(d*y-v*m)*b;return w>=0&&E>=0&&w+E<1};l._convex=function(e,t,n,r,i,s){return(t-r)*(i-n)+(n-e)*(s-r)>=0};t.exports=l}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/math/polyk.js","/math")},{"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],33:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){var c=t.exports={};var h=e("../utils/Utils");c.crossLength=function(e,t){return e[0]*t[1]-e[1]*t[0]};c.crossVZ=function(e,t,n){c.rotate(e,t,-Math.PI/2);c.scale(e,e,n);return e};c.crossZV=function(e,t,n){c.rotate(e,n,Math.PI/2);c.scale(e,e,t);return e};c.rotate=function(e,t,n){if(n!==0){var r=Math.cos(n),i=Math.sin(n),s=t[0],o=t[1];e[0]=r*s-i*o;e[1]=i*s+r*o}else{e[0]=t[0];e[1]=t[1]}};c.rotate90cw=function(e,t){var n=t[0];var r=t[1];e[0]=r;e[1]=-n};c.toLocalFrame=function(e,t,n,r){c.copy(e,t);c.sub(e,e,n);c.rotate(e,e,-r)};c.toGlobalFrame=function(e,t,n,r){c.copy(e,t);c.rotate(e,e,r);c.add(e,e,n)};c.centroid=function(e,t,n,r){c.add(e,t,n);c.add(e,e,r);c.scale(e,e,1/3);return e};c.create=function(){var e=new h.ARRAY_TYPE(2);e[0]=0;e[1]=0;return e};c.clone=function(e){var t=new h.ARRAY_TYPE(2);t[0]=e[0];t[1]=e[1];return t};c.fromValues=function(e,t){var n=new h.ARRAY_TYPE(2);n[0]=e;n[1]=t;return n};c.copy=function(e,t){e[0]=t[0];e[1]=t[1];return e};c.set=function(e,t,n){e[0]=t;e[1]=n;return e};c.add=function(e,t,n){e[0]=t[0]+n[0];e[1]=t[1]+n[1];return e};c.subtract=function(e,t,n){e[0]=t[0]-n[0];e[1]=t[1]-n[1];return e};c.sub=c.subtract;c.multiply=function(e,t,n){e[0]=t[0]*n[0];e[1]=t[1]*n[1];return e};c.mul=c.multiply;c.divide=function(e,t,n){e[0]=t[0]/n[0];e[1]=t[1]/n[1];return e};c.div=c.divide;c.scale=function(e,t,n){e[0]=t[0]*n;e[1]=t[1]*n;return e};c.distance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return Math.sqrt(n*n+r*r)};c.dist=c.distance;c.squaredDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1];return n*n+r*r};c.sqrDist=c.squaredDistance;c.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)};c.len=c.length;c.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n};c.sqrLen=c.squaredLength;c.negate=function(e,t){e[0]=-t[0];e[1]=-t[1];return e};c.normalize=function(e,t){var n=t[0],r=t[1];var i=n*n+r*r;if(i>0){i=1/Math.sqrt(i);e[0]=t[0]*i;e[1]=t[1]*i}return e};c.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]};c.str=function(e){return"vec2("+e[0]+", "+e[1]+")"}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/math/vec2.js","/math")},{"../utils/Utils":52,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],34:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function m(e){e=e||{};v.call(this);this.id=++m._idCounter;this.world=null;this.shapes=[];this.shapeOffsets=[];this.shapeAngles=[];this.mass=e.mass||0;this.invMass=0;this.inertia=0;this.invInertia=0;this.invMassSolve=0;this.invInertiaSolve=0;this.fixedRotation=!!e.fixedRotation||false;this.position=c.fromValues(0,0);if(e.position){c.copy(this.position,e.position)}this.interpolatedPosition=c.fromValues(0,0);this.interpolatedAngle=0;this.previousPosition=c.fromValues(0,0);this.previousAngle=0;this.velocity=c.fromValues(0,0);if(e.velocity){c.copy(this.velocity,e.velocity)}this.vlambda=c.fromValues(0,0);this.wlambda=0;this.angle=e.angle||0;this.angularVelocity=e.angularVelocity||0;this.force=c.create();if(e.force){c.copy(this.force,e.force)}this.angularForce=e.angularForce||0;this.damping=typeof e.damping==="number"?e.damping:.1;this.angularDamping=typeof e.angularDamping==="number"?e.angularDamping:.1;this.type=m.STATIC;if(typeof e.type!=="undefined"){this.type=e.type}else if(!e.mass){this.type=m.STATIC}else{this.type=m.DYNAMIC}this.boundingRadius=0;this.aabb=new d;this.aabbNeedsUpdate=true;this.allowSleep=true;this.wantsToSleep=false;this.sleepState=m.AWAKE;this.sleepSpeedLimit=.2;this.sleepTimeLimit=1;this.gravityScale=1;this.timeLastSleepy=0;this.concavePath=null;this.lastDampingScale=1;this.lastAngularDampingScale=1;this.lastDampingTimeStep=-1;this._wakeUpAfterNarrowphase=false;this.updateMassProperties()}var c=e("../math/vec2"),h=e("poly-decomp"),p=e("../shapes/Convex"),d=e("../collision/AABB"),v=e("../events/EventEmitter");t.exports=m;m.prototype=new v;m._idCounter=0;m.prototype.updateSolveMassProperties=function(){if(this.sleepState===m.SLEEPING||this.type===m.KINEMATIC){this.invMassSolve=0;this.invInertiaSolve=0}else{this.invMassSolve=this.invMass;this.invInertiaSolve=this.invInertia}};m.prototype.setDensity=function(e){var t=this.getArea();this.mass=t*e;this.updateMassProperties()};m.prototype.getArea=function(){var e=0;for(var t=0;t<this.shapes.length;t++){e+=this.shapes[t].area}return e};m.prototype.getAABB=function(){if(this.aabbNeedsUpdate){this.updateAABB()}return this.aabb};var g=new d,y=c.create();m.prototype.updateAABB=function(){var e=this.shapes,t=this.shapeOffsets,n=this.shapeAngles,r=e.length,i=y,s=this.angle;for(var o=0;o!==r;o++){var u=e[o],a=n[o]+s;c.rotate(i,t[o],s);c.add(i,i,this.position);u.computeAABB(g,i,a);if(o===0){this.aabb.copy(g)}else{this.aabb.extend(g)}}this.aabbNeedsUpdate=false};m.prototype.updateBoundingRadius=function(){var e=this.shapes,t=this.shapeOffsets,n=e.length,r=0;for(var i=0;i!==n;i++){var s=e[i],o=c.length(t[i]),u=s.boundingRadius;if(o+u>r){r=o+u}}this.boundingRadius=r};m.prototype.addShape=function(e,t,n){n=n||0;if(t){t=c.fromValues(t[0],t[1])}else{t=c.fromValues(0,0)}this.shapes.push(e);this.shapeOffsets.push(t);this.shapeAngles.push(n);this.updateMassProperties();this.updateBoundingRadius();this.aabbNeedsUpdate=true};m.prototype.removeShape=function(e){var t=this.shapes.indexOf(e);if(t!==-1){this.shapes.splice(t,1);this.shapeOffsets.splice(t,1);this.shapeAngles.splice(t,1);this.aabbNeedsUpdate=true;return true}else{return false}};m.prototype.updateMassProperties=function(){if(this.type===m.STATIC||this.type===m.KINEMATIC){this.mass=Number.MAX_VALUE;this.invMass=0;this.inertia=Number.MAX_VALUE;this.invInertia=0}else{var e=this.shapes,t=e.length,n=this.mass/t,r=0;if(!this.fixedRotation){for(var i=0;i<t;i++){var s=e[i],o=c.squaredLength(this.shapeOffsets[i]),u=s.computeMomentOfInertia(n);r+=u+n*o}this.inertia=r;this.invInertia=r>0?1/r:0}else{this.inertia=Number.MAX_VALUE;this.invInertia=0}this.invMass=1/this.mass}};var b=c.create();m.prototype.applyForce=function(e,t){var n=b;c.sub(n,t,this.position);c.add(this.force,this.force,e);var r=c.crossLength(n,e);this.angularForce+=r};m.prototype.toLocalFrame=function(e,t){c.toLocalFrame(e,t,this.position,this.angle)};m.prototype.toWorldFrame=function(e,t){c.toGlobalFrame(e,t,this.position,this.angle)};m.prototype.fromPolygon=function(e,t){t=t||{};for(var n=this.shapes.length;n>=0;--n){this.removeShape(this.shapes[n])}var r=new h.Polygon;r.vertices=e;r.makeCCW();if(typeof t.removeCollinearPoints==="number"){r.removeCollinearPoints(t.removeCollinearPoints)}if(typeof t.skipSimpleCheck==="undefined"){if(!r.isSimple()){return false}}this.concavePath=r.vertices.slice(0);for(var n=0;n<this.concavePath.length;n++){var i=[0,0];c.copy(i,this.concavePath[n]);this.concavePath[n]=i}var s;if(t.optimalDecomp){s=r.decomp()}else{s=r.quickDecomp()}var o=c.create();for(var n=0;n!==s.length;n++){var u=new p(s[n].vertices);for(var a=0;a!==u.vertices.length;a++){var i=u.vertices[a];c.sub(i,i,u.centerOfMass)}c.scale(o,u.centerOfMass,1);u.updateTriangles();u.updateCenterOfMass();u.updateBoundingRadius();this.addShape(u,o)}this.adjustCenterOfMass();this.aabbNeedsUpdate=true;return true};var w=c.fromValues(0,0),E=c.fromValues(0,0),S=c.fromValues(0,0),x=c.fromValues(0,0);m.prototype.adjustCenterOfMass=function(){var e=E,t=S,n=x,r=0;c.set(t,0,0);for(var i=0;i!==this.shapes.length;i++){var s=this.shapes[i],o=this.shapeOffsets[i];c.scale(e,o,s.area);c.add(t,t,e);r+=s.area}c.scale(n,t,1/r);for(var i=0;i!==this.shapes.length;i++){var s=this.shapes[i],o=this.shapeOffsets[i];if(!o){o=this.shapeOffsets[i]=c.create()}c.sub(o,o,n)}c.add(this.position,this.position,n);for(var i=0;this.concavePath&&i<this.concavePath.length;i++){c.sub(this.concavePath[i],this.concavePath[i],n)}this.updateMassProperties();this.updateBoundingRadius()};m.prototype.setZeroForce=function(){c.set(this.force,0,0);this.angularForce=0};m.prototype.resetConstraintVelocity=function(){var e=this,t=e.vlambda;c.set(t,0,0);e.wlambda=0};m.prototype.addConstraintVelocity=function(){var e=this,t=e.velocity;c.add(t,t,e.vlambda);e.angularVelocity+=e.wlambda};m.prototype.applyDamping=function(e){if(this.type===m.DYNAMIC){if(e!==this.lastDampingTimeStep){this.lastDampingScale=Math.pow(1-this.damping,e);this.lastAngularDampingScale=Math.pow(1-this.angularDamping,e);this.lastDampingTimeStep=e}var t=this.velocity;c.scale(t,t,this.lastDampingScale);this.angularVelocity*=this.lastAngularDampingScale}};m.prototype.wakeUp=function(){var e=this.sleepState;this.sleepState=m.AWAKE;this.idleTime=0;if(e!==m.AWAKE){this.emit(m.wakeUpEvent)}};m.prototype.sleep=function(){this.sleepState=m.SLEEPING;this.angularVelocity=0;this.angularForce=0;c.set(this.velocity,0,0);c.set(this.force,0,0);this.emit(m.sleepEvent)};m.prototype.sleepTick=function(e,t,n){if(!this.allowSleep||this.type===m.SLEEPING){return}this.wantsToSleep=false;var r=this.sleepState,i=c.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2),s=Math.pow(this.sleepSpeedLimit,2);if(i>=s){this.idleTime=0;this.sleepState=m.AWAKE}else{this.idleTime+=n;this.sleepState=m.SLEEPY}if(this.idleTime>this.sleepTimeLimit){if(!t){this.sleep()}else{this.wantsToSleep=true}}};m.prototype.getVelocityFromPosition=function(e,t){e=e||c.create();c.sub(e,this.position,this.previousPosition);c.scale(e,e,1/t);return e};m.prototype.getAngularVelocityFromPosition=function(e){return(this.angle-this.previousAngle)/e};m.prototype.overlaps=function(e){return this.world.overlapKeeper.bodiesAreOverlapping(this,e)};m.sleepyEvent={type:"sleepy"};m.sleepEvent={type:"sleep"};m.wakeUpEvent={type:"wakeup"};m.DYNAMIC=1;m.STATIC=2;m.KINEMATIC=4;m.AWAKE=0;m.SLEEPY=1;m.SLEEPING=2}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/objects/Body.js","/objects")},{"../collision/AABB":11,"../events/EventEmitter":29,"../math/vec2":33,"../shapes/Convex":41,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1,"poly-decomp":9}],35:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function d(e,t,n){n=n||{};h.call(this,e,t,n);this.localAnchorA=c.fromValues(0,0);this.localAnchorB=c.fromValues(0,0);if(n.localAnchorA){c.copy(this.localAnchorA,n.localAnchorA)}if(n.localAnchorB){c.copy(this.localAnchorB,n.localAnchorB)}if(n.worldAnchorA){this.setWorldAnchorA(n.worldAnchorA)}if(n.worldAnchorB){this.setWorldAnchorB(n.worldAnchorB)}var r=c.create();var i=c.create();this.getWorldAnchorA(r);this.getWorldAnchorB(i);var s=c.distance(r,i);this.restLength=typeof n.restLength==="number"?n.restLength:s}var c=e("../math/vec2");var h=e("./Spring");var p=e("../utils/Utils");t.exports=d;d.prototype=new h;d.prototype.setWorldAnchorA=function(e){this.bodyA.toLocalFrame(this.localAnchorA,e)};d.prototype.setWorldAnchorB=function(e){this.bodyB.toLocalFrame(this.localAnchorB,e)};d.prototype.getWorldAnchorA=function(e){this.bodyA.toWorldFrame(e,this.localAnchorA)};d.prototype.getWorldAnchorB=function(e){this.bodyB.toWorldFrame(e,this.localAnchorB)};var v=c.create(),m=c.create(),g=c.create(),y=c.create(),b=c.create(),w=c.create(),E=c.create(),S=c.create(),x=c.create();d.prototype.applyForce=function(){var e=this.stiffness,t=this.damping,n=this.restLength,r=this.bodyA,i=this.bodyB,s=v,o=m,u=g,a=y,f=x;var l=b,h=w,p=E,d=S;this.getWorldAnchorA(l);this.getWorldAnchorB(h);c.sub(p,l,r.position);c.sub(d,h,i.position);c.sub(s,h,l);var T=c.len(s);c.normalize(o,s);c.sub(u,i.velocity,r.velocity);c.crossZV(f,i.angularVelocity,d);c.add(u,u,f);c.crossZV(f,r.angularVelocity,p);c.sub(u,u,f);c.scale(a,o,-e*(T-n)-t*c.dot(u,o));c.sub(r.force,r.force,a);c.add(i.force,i.force,a);var N=c.crossLength(p,a);var C=c.crossLength(d,a);r.angularForce-=N;i.angularForce+=C}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/objects/LinearSpring.js","/objects")},{"../math/vec2":33,"../utils/Utils":52,"./Spring":37,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],36:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e,t,n){n=n||{};h.call(this,e,t,n);this.restAngle=typeof n.restAngle==="number"?n.restAngle:t.angle-e.angle}var c=e("../math/vec2");var h=e("./Spring");t.exports=p;p.prototype=new h;p.prototype.applyForce=function(){var e=this.stiffness,t=this.damping,n=this.restAngle,r=this.bodyA,i=this.bodyB,s=i.angle-r.angle,o=i.angularVelocity-r.angularVelocity;var u=-e*(s-n)-t*o*0;r.angularForce-=u;i.angularForce+=u}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/objects/RotationalSpring.js","/objects")},{"../math/vec2":33,"./Spring":37,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],37:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e,t,n){n=h.defaults(n,{stiffness:100,damping:1});this.stiffness=n.stiffness;this.damping=n.damping;this.bodyA=e;this.bodyB=t}var c=e("../math/vec2");var h=e("../utils/Utils");t.exports=p;p.prototype.applyForce=function(){}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/objects/Spring.js","/objects")},{"../math/vec2":33,"../utils/Utils":52,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],38:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){t.exports={AABB:e("./collision/AABB"),AngleLockEquation:e("./equations/AngleLockEquation"),Body:e("./objects/Body"),Broadphase:e("./collision/Broadphase"),Capsule:e("./shapes/Capsule"),Circle:e("./shapes/Circle"),Constraint:e("./constraints/Constraint"),ContactEquation:e("./equations/ContactEquation"),ContactMaterial:e("./material/ContactMaterial"),Convex:e("./shapes/Convex"),DistanceConstraint:e("./constraints/DistanceConstraint"),Equation:e("./equations/Equation"),EventEmitter:e("./events/EventEmitter"),FrictionEquation:e("./equations/FrictionEquation"),GearConstraint:e("./constraints/GearConstraint"),GridBroadphase:e("./collision/GridBroadphase"),GSSolver:e("./solver/GSSolver"),Heightfield:e("./shapes/Heightfield"),Line:e("./shapes/Line"),LockConstraint:e("./constraints/LockConstraint"),Material:e("./material/Material"),Narrowphase:e("./collision/Narrowphase"),NaiveBroadphase:e("./collision/NaiveBroadphase"),Particle:e("./shapes/Particle"),Plane:e("./shapes/Plane"),RevoluteConstraint:e("./constraints/RevoluteConstraint"),PrismaticConstraint:e("./constraints/PrismaticConstraint"),Rectangle:e("./shapes/Rectangle"),RotationalVelocityEquation:e("./equations/RotationalVelocityEquation"),SAPBroadphase:e("./collision/SAPBroadphase"),Shape:e("./shapes/Shape"),Solver:e("./solver/Solver"),Spring:e("./objects/Spring"),LinearSpring:e("./objects/LinearSpring"),RotationalSpring:e("./objects/RotationalSpring"),Utils:e("./utils/Utils"),World:e("./world/World"),vec2:e("./math/vec2"),version:e("../package.json").version}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/p2.js","/")},{"../package.json":10,"./collision/AABB":11,"./collision/Broadphase":12,"./collision/GridBroadphase":13,"./collision/NaiveBroadphase":14,"./collision/Narrowphase":15,"./collision/SAPBroadphase":16,"./constraints/Constraint":17,"./constraints/DistanceConstraint":18,"./constraints/GearConstraint":19,"./constraints/LockConstraint":20,"./constraints/PrismaticConstraint":21,"./constraints/RevoluteConstraint":22,"./equations/AngleLockEquation":23,"./equations/ContactEquation":24,"./equations/Equation":25,"./equations/FrictionEquation":26,"./equations/RotationalVelocityEquation":28,"./events/EventEmitter":29,"./material/ContactMaterial":30,"./material/Material":31,"./math/vec2":33,"./objects/Body":34,"./objects/LinearSpring":35,"./objects/RotationalSpring":36,"./objects/Spring":37,"./shapes/Capsule":39,"./shapes/Circle":40,"./shapes/Convex":41,"./shapes/Heightfield":42,"./shapes/Line":43,"./shapes/Particle":44,"./shapes/Plane":45,"./shapes/Rectangle":46,"./shapes/Shape":47,"./solver/GSSolver":48,"./solver/Solver":49,"./utils/Utils":52,"./world/World":56,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],39:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e,t){this.length=e||1;this.radius=t||1;c.call(this,c.CAPSULE)}var c=e("./Shape"),h=e("../math/vec2");t.exports=p;p.prototype=new c;p.prototype.computeMomentOfInertia=function(e){var t=this.radius,n=this.length+t,r=t*2;return e*(r*r+n*n)/12};p.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2};p.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+this.radius*2*this.length};var d=h.create();p.prototype.computeAABB=function(e,t,n){var r=this.radius;h.set(d,this.length/2,0);if(n!==0){h.rotate(d,d,n)}h.set(e.upperBound,Math.max(d[0]+r,-d[0]+r),Math.max(d[1]+r,-d[1]+r));h.set(e.lowerBound,Math.min(d[0]-r,-d[0]-r),Math.min(d[1]-r,-d[1]-r));h.add(e.lowerBound,e.lowerBound,t);h.add(e.upperBound,e.upperBound,t)}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/shapes/Capsule.js","/shapes")},{"../math/vec2":33,"./Shape":47,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],40:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e){this.radius=e||1;c.call(this,c.CIRCLE)}var c=e("./Shape"),h=e("../math/vec2");t.exports=p;p.prototype=new c;p.prototype.computeMomentOfInertia=function(e){var t=this.radius;return e*t*t/2};p.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius};p.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius};p.prototype.computeAABB=function(e,t,n){var r=this.radius;h.set(e.upperBound,r,r);h.set(e.lowerBound,-r,-r);if(t){h.add(e.lowerBound,e.lowerBound,t);h.add(e.upperBound,e.upperBound,t)}}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/shapes/Circle.js","/shapes")},{"../math/vec2":33,"./Shape":47,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],41:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function v(e,t){this.vertices=[];this.axes=[];for(var n=0;n<e.length;n++){var r=h.create();h.copy(r,e[n]);this.vertices.push(r)}if(t){for(var n=0;n<t.length;n++){var i=h.create();h.copy(i,t[n]);this.axes.push(i)}}else{for(var n=0;n<e.length;n++){var s=e[n];var o=e[(n+1)%e.length];var u=h.create();h.sub(u,o,s);h.rotate90cw(u,u);h.normalize(u,u);this.axes.push(u)}}this.centerOfMass=h.fromValues(0,0);this.triangles=[];if(this.vertices.length){this.updateTriangles();this.updateCenterOfMass()}this.boundingRadius=0;c.call(this,c.CONVEX);this.updateBoundingRadius();this.updateArea();if(this.area<0){throw new Error("Convex vertices must be given in conter-clockwise winding.")}}var c=e("./Shape"),h=e("../math/vec2"),p=e("../math/polyk"),d=e("poly-decomp");t.exports=v;v.prototype=new c;var m=h.create();var g=h.create();v.prototype.projectOntoLocalAxis=function(e,t){var n=null,r=null,i,s,e=m;for(var o=0;o<this.vertices.length;o++){i=this.vertices[o];s=h.dot(i,e);if(n===null||s>n){n=s}if(r===null||s<r){r=s}}if(r>n){var u=r;r=n;n=u}h.set(t,r,n)};v.prototype.projectOntoWorldAxis=function(e,t,n,r){var i=g;this.projectOntoLocalAxis(e,r);if(n!==0){h.rotate(i,e,n)}else{i=e}var s=h.dot(t,i);h.set(r,r[0]+s,r[1]+s)};v.prototype.updateTriangles=function(){this.triangles.length=0;var e=[];for(var t=0;t<this.vertices.length;t++){var n=this.vertices[t];e.push(n[0],n[1])}var r=p.Triangulate(e);for(var t=0;t<r.length;t+=3){var i=r[t],s=r[t+1],o=r[t+2];this.triangles.push([i,s,o])}};var y=h.create(),b=h.create(),w=h.create(),E=h.create(),S=h.create(),x=h.create(),T=h.create(),N=h.create(),C=h.create();v.prototype.updateCenterOfMass=function(){var e=this.triangles,t=this.vertices,n=this.centerOfMass,r=y,i=C,s=w,o=E,u=S,a=x,f=T,l=N,c=b;h.set(n,0,0);var p=0;for(var d=0;d!==e.length;d++){var m=e[d],s=t[m[0]],o=t[m[1]],u=t[m[2]];h.centroid(r,s,o,u);var g=v.triangleArea(s,o,u);p+=g;h.scale(c,r,g);h.add(n,n,c)}h.scale(n,n,1/p)};v.prototype.computeMomentOfInertia=function(e){var t=0,n=0,r=this.vertices.length;for(var i=r-1,s=0;s<r;i=s,s++){var o=this.vertices[i];var u=this.vertices[s];var a=Math.abs(h.crossLength(o,u));var f=h.dot(u,u)+h.dot(u,o)+h.dot(o,o);t+=a*f;n+=a}return e/6*(t/n)};v.prototype.updateBoundingRadius=function(){var e=this.vertices,t=0;for(var n=0;n!==e.length;n++){var r=h.squaredLength(e[n]);if(r>t){t=r}}this.boundingRadius=Math.sqrt(t)};v.triangleArea=function(e,t,n){return((t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1]))*.5};v.prototype.updateArea=function(){this.updateTriangles();this.area=0;var e=this.triangles,t=this.vertices;for(var n=0;n!==e.length;n++){var r=e[n],i=t[r[0]],s=t[r[1]],o=t[r[2]];var u=v.triangleArea(i,s,o);this.area+=u}};v.prototype.computeAABB=function(e,t,n){e.setFromPoints(this.vertices,t,n,0)}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/shapes/Convex.js","/shapes")},{"../math/polyk":32,"../math/vec2":33,"./Shape":47,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1,"poly-decomp":9}],42:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function d(e,t){t=p.defaults(t,{maxValue:null,minValue:null,elementWidth:.1});if(t.minValue===null||t.maxValue===null){t.maxValue=e[0];t.minValue=e[0];for(var n=0;n!==e.length;n++){var r=e[n];if(r>t.maxValue){t.maxValue=r}if(r<t.minValue){t.minValue=r}}}this.data=e;this.maxValue=t.maxValue;this.minValue=t.minValue;this.elementWidth=t.elementWidth;c.call(this,c.HEIGHTFIELD)}var c=e("./Shape"),h=e("../math/vec2"),p=e("../utils/Utils");t.exports=d;d.prototype=new c;d.prototype.computeMomentOfInertia=function(e){return Number.MAX_VALUE};d.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE};d.prototype.updateArea=function(){var e=this.data,t=0;for(var n=0;n<e.length-1;n++){t+=(e[n]+e[n+1])/2*this.elementWidth}this.area=t};d.prototype.computeAABB=function(e,t,n){e.upperBound[0]=this.elementWidth*this.data.length+t[0];e.upperBound[1]=this.maxValue+t[1];e.lowerBound[0]=t[0];e.lowerBound[1]=-Number.MAX_VALUE}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/shapes/Heightfield.js","/shapes")},{"../math/vec2":33,"../utils/Utils":52,"./Shape":47,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],43:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e){this.length=e||1;c.call(this,c.LINE)}var c=e("./Shape"),h=e("../math/vec2");t.exports=p;p.prototype=new c;p.prototype.computeMomentOfInertia=function(e){return e*Math.pow(this.length,2)/12};p.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var d=[h.create(),h.create()];p.prototype.computeAABB=function(e,t,n){var r=this.length/2;h.set(d[0],-r,0);h.set(d[1],r,0);e.setFromPoints(d,t,n,0)}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/shapes/Line.js","/shapes")},{"../math/vec2":33,"./Shape":47,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],44:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(){c.call(this,c.PARTICLE)}var c=e("./Shape"),h=e("../math/vec2");t.exports=p;p.prototype=new c;p.prototype.computeMomentOfInertia=function(e){return 0};p.prototype.updateBoundingRadius=function(){this.boundingRadius=0};p.prototype.computeAABB=function(e,t,n){h.copy(e.lowerBound,t);h.copy(e.upperBound,t)}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/shapes/Particle.js","/shapes")},{"../math/vec2":33,"./Shape":47,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],45:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function d(){c.call(this,c.PLANE)}var c=e("./Shape"),h=e("../math/vec2"),p=e("../utils/Utils");t.exports=d;d.prototype=new c;d.prototype.computeMomentOfInertia=function(e){return 0};d.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE};d.prototype.computeAABB=function(e,t,n){var r=0,i=h.set;if(typeof n==="number"){r=n%(2*Math.PI)}if(r===0){i(e.lowerBound,-Number.MAX_VALUE,-Number.MAX_VALUE);i(e.upperBound,Number.MAX_VALUE,0)}else if(r===Math.PI/2){i(e.lowerBound,0,-Number.MAX_VALUE);i(e.upperBound,Number.MAX_VALUE,Number.MAX_VALUE)}else if(r===Math.PI){i(e.lowerBound,-Number.MAX_VALUE,0);i(e.upperBound,Number.MAX_VALUE,Number.MAX_VALUE)}else if(r===3*Math.PI/2){i(e.lowerBound,-Number.MAX_VALUE,-Number.MAX_VALUE);i(e.upperBound,0,Number.MAX_VALUE)}else{i(e.lowerBound,-Number.MAX_VALUE,-Number.MAX_VALUE);i(e.upperBound,Number.MAX_VALUE,Number.MAX_VALUE)}h.add(e.lowerBound,e.lowerBound,t);h.add(e.upperBound,e.upperBound,t)};d.prototype.updateArea=function(){this.area=Number.MAX_VALUE}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/shapes/Plane.js","/shapes")},{"../math/vec2":33,"../utils/Utils":52,"./Shape":47,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],46:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function d(e,t){this.width=e||1;this.height=t||1;var n=[c.fromValues(-e/2,-t/2),c.fromValues(e/2,-t/2),c.fromValues(e/2,t/2),c.fromValues(-e/2,t/2)];var r=[c.fromValues(1,0),c.fromValues(0,1)];p.call(this,n,r);this.type=h.RECTANGLE}var c=e("../math/vec2"),h=e("./Shape"),p=e("./Convex");t.exports=d;d.prototype=new p([]);d.prototype.computeMomentOfInertia=function(e){var t=this.width,n=this.height;return e*(n*n+t*t)/12};d.prototype.updateBoundingRadius=function(){var e=this.width,t=this.height;this.boundingRadius=Math.sqrt(e*e+t*t)/2};var v=c.create(),m=c.create(),g=c.create(),y=c.create();d.prototype.computeAABB=function(e,t,n){e.setFromPoints(this.vertices,t,n,0)};d.prototype.updateArea=function(){this.area=this.width*this.height}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/shapes/Rectangle.js","/shapes")},{"../math/vec2":33,"./Convex":41,"./Shape":47,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],47:[function(e,t,n){(function(e,n,r,i,s,o,u,a,f){function l(e){this.type=e;this.id=l.idCounter++;this.boundingRadius=0;this.collisionGroup=1;this.collisionMask=1;if(e){this.updateBoundingRadius()}this.material=null;this.area=0;this.sensor=false;this.updateArea()}t.exports=l;l.idCounter=0;l.CIRCLE=1;l.PARTICLE=2;l.PLANE=4;l.CONVEX=8;l.LINE=16;l.RECTANGLE=32;l.CAPSULE=64;l.HEIGHTFIELD=128;l.prototype.computeMomentOfInertia=function(e){throw new Error("Shape.computeMomentOfInertia is not implemented in this Shape...")};l.prototype.updateBoundingRadius=function(){throw new Error("Shape.updateBoundingRadius is not implemented in this Shape...")};l.prototype.updateArea=function(){};l.prototype.computeAABB=function(e,t,n){}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/shapes/Shape.js","/shapes")},{"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],48:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function v(e){h.call(this,e,h.GS);e=e||{};this.iterations=e.iterations||10;this.tolerance=e.tolerance||1e-10;this.arrayStep=30;this.lambda=new p.ARRAY_TYPE(this.arrayStep);this.Bs=new p.ARRAY_TYPE(this.arrayStep);this.invCs=new p.ARRAY_TYPE(this.arrayStep);this.useZeroRHS=false;this.frictionIterations=0;this.usedIterations=0}function m(e){var t=e.length;while(t--){e[t]=+0}}var c=e("../math/vec2"),h=e("./Solver"),p=e("../utils/Utils"),d=e("../equations/FrictionEquation");t.exports=v;v.prototype=new h;v.prototype.solve=function(e,t){this.sortEquations();var n=0,r=this.iterations,i=this.frictionIterations,s=this.equations,o=s.length,u=Math.pow(this.tolerance*o,2),a=t.bodies,f=t.bodies.length,l=c.add,h=c.set,g=this.useZeroRHS,y=this.lambda;this.usedIterations=0;if(o){for(var b=0;b!==f;b++){var w=a[b];w.updateSolveMassProperties()}}if(y.length<o){y=this.lambda=new p.ARRAY_TYPE(o+this.arrayStep);this.Bs=new p.ARRAY_TYPE(o+this.arrayStep);this.invCs=new p.ARRAY_TYPE(o+this.arrayStep)}m(y);var E=this.invCs,S=this.Bs,y=this.lambda;for(var b=0;b!==s.length;b++){var x=s[b];if(x.timeStep!==e||x.needsUpdate){x.timeStep=e;x.update()}S[b]=x.computeB(x.a,x.b,e);E[b]=x.computeInvC(x.epsilon)}var T,N,x,C,b,k;if(o!==0){for(b=0;b!==f;b++){var w=a[b];w.resetConstraintVelocity()}if(i){for(n=0;n!==i;n++){C=0;for(k=0;k!==o;k++){x=s[k];var L=v.iterateEquation(k,x,x.epsilon,S,E,y,g,e,n);C+=Math.abs(L)}this.usedIterations++;if(C*C<=u){break}}v.updateMultipliers(s,y,1/e);for(k=0;k!==o;k++){var A=s[k];if(A instanceof d){var O=0;for(var M=0;M!==A.contactEquations.length;M++){O+=A.contactEquations[M].multiplier}O*=A.frictionCoefficient/A.contactEquations.length;A.maxForce=O;A.minForce=-O}}}for(n=0;n!==r;n++){C=0;for(k=0;k!==o;k++){x=s[k];var L=v.iterateEquation(k,x,x.epsilon,S,E,y,g,e,n);C+=Math.abs(L)}this.usedIterations++;if(C*C<=u){break}}for(b=0;b!==f;b++){a[b].addConstraintVelocity()}v.updateMultipliers(s,y,1/e)}};v.updateMultipliers=function(e,t,n){var r=e.length;while(r--){e[r].multiplier=t[r]*n}};v.iterateEquation=function(e,t,n,r,i,s,o,u,a){var f=r[e],l=i[e],c=s[e],h=t.computeGWlambda();var p=t.maxForce,d=t.minForce;if(o){f=0}var v=l*(f-h-n*c);var m=c+v;if(m<d*u){v=d*u-c}else if(m>p*u){v=p*u-c}s[e]+=v;t.addToWlambda(v);return v}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/solver/GSSolver.js","/solver")},{"../equations/FrictionEquation":26,"../math/vec2":33,"../utils/Utils":52,"./Solver":49,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],49:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(e,t){e=e||{};h.call(this);this.type=t;this.equations=[];this.equationSortFunction=e.equationSortFunction||false}var c=e("../utils/Utils"),h=e("../events/EventEmitter");t.exports=p;p.prototype=new h;p.prototype.solve=function(e,t){throw new Error("Solver.solve should be implemented by subclasses!")};var d={bodies:[]};p.prototype.solveIsland=function(e,t){this.removeAllEquations();if(t.equations.length){this.addEquations(t.equations);d.bodies.length=0;t.getBodies(d.bodies);if(d.bodies.length){this.solve(e,d)}}};p.prototype.sortEquations=function(){if(this.equationSortFunction){this.equations.sort(this.equationSortFunction)}};p.prototype.addEquation=function(e){if(e.enabled){this.equations.push(e)}};p.prototype.addEquations=function(e){for(var t=0,n=e.length;t!==n;t++){var r=e[t];if(r.enabled){this.equations.push(r)}}};p.prototype.removeEquation=function(e){var t=this.equations.indexOf(e);if(t!==-1){this.equations.splice(t,1)}};p.prototype.removeAllEquations=function(){this.equations.length=0};p.GS=1;p.ISLAND=2}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/solver/Solver.js","/solver")},{"../events/EventEmitter":29,"../utils/Utils":52,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],50:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function p(){this.overlappingShapesLastState=new c;this.overlappingShapesCurrentState=new c;this.recordPool=[];this.tmpDict=new c;this.tmpArray1=[]}function d(e,t,n,r){this.shapeA=t;this.shapeB=r;this.bodyA=e;this.bodyB=n}var c=e("./TupleDictionary");var h=e("./Utils");t.exports=p;p.prototype.tick=function(){var e=this.overlappingShapesLastState;var t=this.overlappingShapesCurrentState;var n=e.keys.length;while(n--){var r=e.keys[n];var i=e.getByKey(r);var s=t.getByKey(r);if(i&&!s){this.recordPool.push(i)}}e.reset();e.copy(t);t.reset()};p.prototype.setOverlapping=function(e,t,n,r){var i=this.overlappingShapesLastState;var s=this.overlappingShapesCurrentState;if(!s.get(t.id,r.id)){var o;if(this.recordPool.length){o=this.recordPool.pop();o.set(e,t,n,r)}else{o=new d(e,t,n,r)}s.set(t.id,r.id,o)}};p.prototype.getNewOverlaps=function(e){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,e)};p.prototype.getEndOverlaps=function(e){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,e)};p.prototype.bodiesAreOverlapping=function(e,t){var n=this.overlappingShapesCurrentState;var r=n.keys.length;while(r--){var i=n.keys[r];var s=n.data[i];if(s.bodyA===e&&s.bodyB===t||s.bodyA===t&&s.bodyB===e){return true}}return false};p.prototype.getDiff=function(e,t,n){var n=n||[];var r=e;var i=t;n.length=0;var s=i.keys.length;while(s--){var o=i.keys[s];var u=i.data[o];if(!u){throw new Error("Key "+o+" had no data!")}var a=r.data[o];if(!a){n.push(u)}}return n};p.prototype.isNewOverlap=function(e,t){var n=e.id|0,r=t.id|0;var i=this.overlappingShapesLastState;var s=this.overlappingShapesCurrentState;return!!!i.get(n,r)&&!!s.get(n,r)};p.prototype.getNewBodyOverlaps=function(e){this.tmpArray1.length=0;var t=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(t,e)};p.prototype.getEndBodyOverlaps=function(e){this.tmpArray1.length=0;var t=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(t,e)};p.prototype.getBodyDiff=function(e,t){t=t||[];var n=this.tmpDict;var r=e.length;while(r--){var i=e[r];n.set(i.bodyA.id|0,i.bodyB.id|0,i)}r=n.keys.length;while(r--){var i=n.getByKey(n.keys[r]);if(i){t.push(i.bodyA,i.bodyB)}}n.reset();return t};d.prototype.set=function(e,t,n,r){d.call(this,e,t,n,r)}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/utils/OverlapKeeper.js","/utils")},{"./TupleDictionary":51,"./Utils":52,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],51:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function h(){this.data={};this.keys=[]}var c=e("./Utils");t.exports=h;h.prototype.getKey=function(e,t){e=e|0;t=t|0;if((e|0)===(t|0)){return-1}return((e|0)>(t|0)?e<<16|t&65535:t<<16|e&65535)|0};h.prototype.getByKey=function(e){e=e|0;return this.data[e]};h.prototype.get=function(e,t){return this.data[this.getKey(e,t)]};h.prototype.set=function(e,t,n){if(!n){throw new Error("No data!")}var r=this.getKey(e,t);if(!this.data[r]){this.keys.push(r)}this.data[r]=n;return r};h.prototype.reset=function(){var e=this.data,t=this.keys;var n=t.length;while(n--){delete e[t[n]]}t.length=0};h.prototype.copy=function(e){this.reset();c.appendArray(this.keys,e.keys);var t=e.keys.length;while(t--){var n=e.keys[t];this.data[n]=e.data[n]}}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/utils/TupleDictionary.js","/utils")},{"./Utils":52,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],52:[function(e,t,n){(function(e,n,r,i,s,o,u,a,f){function l(){}t.exports=l;l.appendArray=function(e,t){if(t.length<15e4){e.push.apply(e,t)}else{for(var n=0,r=t.length;n!==r;++n){e.push(t[n])}}};l.splice=function(e,t,n){n=n||1;for(var r=t,i=e.length-n;r<i;r++){e[r]=e[r+n]}e.length=i};if(typeof P2_ARRAY_TYPE!=="undefined"){l.ARRAY_TYPE=P2_ARRAY_TYPE}else if(typeof Float32Array!=="undefined"){l.ARRAY_TYPE=Float32Array}else{l.ARRAY_TYPE=Array}l.extend=function(e,t){for(var n in t){e[n]=t[n]}};l.defaults=function(e,t){e=e||{};for(var n in t){if(!(n in e)){e[n]=t[n]}}return e}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/utils/Utils.js","/utils")},{"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],53:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function h(){this.equations=[];this.bodies=[]}var c=e("../objects/Body");t.exports=h;h.prototype.reset=function(){this.equations.length=this.bodies.length=0};var p=[];h.prototype.getBodies=function(e){var t=e||[],n=this.equations;p.length=0;for(var r=0;r!==n.length;r++){var i=n[r];if(p.indexOf(i.bodyA.id)===-1){t.push(i.bodyA);p.push(i.bodyA.id)}if(p.indexOf(i.bodyB.id)===-1){t.push(i.bodyB);p.push(i.bodyB.id)}}return t};h.prototype.wantsToSleep=function(){for(var e=0;e<this.bodies.length;e++){var t=this.bodies[e];if(t.type===c.DYNAMIC&&!t.wantsToSleep){return false}}return true};h.prototype.sleep=function(){for(var e=0;e<this.bodies.length;e++){var t=this.bodies[e];t.sleep()}return true}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/world/Island.js","/world")},{"../objects/Body":34,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],54:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function v(e){this._nodePool=[];this._islandPool=[];this.equations=[];this.islands=[];this.nodes=[];this.queue=[]}var c=e("../math/vec2"),h=e("./Island"),p=e("./IslandNode"),d=e("../objects/Body");t.exports=v;v.getUnvisitedNode=function(e){var t=e.length;for(var n=0;n!==t;n++){var r=e[n];if(!r.visited&&r.body.type===d.DYNAMIC){return r}}return false};v.prototype.visit=function(e,t,n){t.push(e.body);var r=e.equations.length;for(var i=0;i!==r;i++){var s=e.equations[i];if(n.indexOf(s)===-1){n.push(s)}}};v.prototype.bfs=function(e,t,n){var r=this.queue;r.length=0;r.push(e);e.visited=true;this.visit(e,t,n);while(r.length){var i=r.pop();var s;while(s=v.getUnvisitedNode(i.neighbors)){s.visited=true;this.visit(s,t,n);if(s.body.type===d.DYNAMIC){r.push(s)}}}};v.prototype.split=function(e){var t=e.bodies,n=this.nodes,r=this.equations;while(n.length){this._nodePool.push(n.pop())}for(var i=0;i!==t.length;i++){if(this._nodePool.length){var s=this._nodePool.pop();s.reset();s.body=t[i];n.push(s)}else{n.push(new p(t[i]))}}for(var o=0;o!==r.length;o++){var u=r[o],i=t.indexOf(u.bodyA),a=t.indexOf(u.bodyB),f=n[i],l=n[a];f.neighbors.push(l);l.neighbors.push(f);f.equations.push(u);l.equations.push(u)}var c=this.islands;while(c.length){var d=c.pop();d.reset();this._islandPool.push(d)}var m;while(m=v.getUnvisitedNode(n)){var d=this._islandPool.length?this._islandPool.pop():new h;this.bfs(m,d.bodies,d.equations);c.push(d)}return c}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/world/IslandManager.js","/world")},{"../math/vec2":33,"../objects/Body":34,"./Island":53,"./IslandNode":55,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],55:[function(e,t,n){(function(e,n,r,i,s,o,u,a,f){function l(e){this.body=e;this.neighbors=[];this.equations=[];this.visited=false}t.exports=l;l.prototype.reset=function(){this.equations.length=0;this.neighbors.length=0;this.visited=false;this.body=null}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/world/IslandNode.js","/world")},{"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}],56:[function(e,t,n){(function(n,r,i,s,o,u,a,f,l){function z(e){S.apply(this);e=e||{};this.springs=[];this.bodies=[];this.disabledBodyCollisionPairs=[];this.solver=e.solver||new c;this.narrowphase=new j(this);this.islandManager=new q;this.gravity=d.fromValues(0,-9.78);if(e.gravity){d.copy(this.gravity,e.gravity)}this.frictionGravity=d.length(this.gravity)||10;this.useWorldGravityAsFrictionGravity=true;this.useFrictionGravityOnZeroGravity=true;this.doProfiling=e.doProfiling||false;this.lastStepTime=0;this.broadphase=e.broadphase||new p;this.broadphase.setWorld(this);this.constraints=[];this.defaultMaterial=new C;this.defaultContactMaterial=new k(this.defaultMaterial,this.defaultMaterial);this.lastTimeStep=1/60;this.applySpringForces=true;this.applyDamping=true;this.applyGravity=true;this.solveConstraints=true;this.contactMaterials=[];this.time=0;this.stepping=false;this.bodiesToBeRemoved=[];this.fixedStepTime=0;this.islandSplit=typeof e.islandSplit!=="undefined"?!!e.islandSplit:false;this.emitImpactEvent=true;this._constraintIdCounter=0;this._bodyIdCounter=0;this.postStepEvent={type:"postStep"};this.addBodyEvent={type:"addBody",body:null};this.removeBodyEvent={type:"removeBody",body:null};this.addSpringEvent={type:"addSpring",spring:null};this.impactEvent={type:"impact",bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null};this.postBroadphaseEvent={type:"postBroadphase",pairs:null};this.sleepMode=z.NO_SLEEPING;this.beginContactEvent={type:"beginContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null,contactEquations:[]};this.endContactEvent={type:"endContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null};this.preSolveEvent={type:"preSolve",contactEquations:null,frictionEquations:null};this.overlappingShapesLastState={keys:[]};this.overlappingShapesCurrentState={keys:[]};this.overlapKeeper=new I}function it(e){if(!e){return e}return[e[0],e[1]]}function st(e,t){for(var n in t){e[n]=t[n]}}function ot(e){return{id:e.id,materialA:e.materialA.id,materialB:e.materialB.id,friction:e.friction,restitution:e.restitution,stiffness:e.stiffness,relaxation:e.relaxation,frictionStiffness:e.frictionStiffness,frictionRelaxation:e.frictionRelaxation}}var c=e("../solver/GSSolver"),h=e("../solver/Solver"),p=e("../collision/NaiveBroadphase"),d=e("../math/vec2"),v=e("../shapes/Circle"),m=e("../shapes/Rectangle"),g=e("../shapes/Convex"),y=e("../shapes/Line"),b=e("../shapes/Plane"),w=e("../shapes/Capsule"),E=e("../shapes/Particle"),S=e("../events/EventEmitter"),x=e("../objects/Body"),T=e("../shapes/Shape"),N=e("../objects/LinearSpring"),C=e("../material/Material"),k=e("../material/ContactMaterial"),L=e("../constraints/DistanceConstraint"),A=e("../constraints/Constraint"),O=e("../constraints/LockConstraint"),M=e("../constraints/RevoluteConstraint"),_=e("../constraints/PrismaticConstraint"),D=e("../constraints/GearConstraint"),P=e("../../package.json"),H=e("../collision/Broadphase"),B=e("../collision/SAPBroadphase"),j=e("../collision/Narrowphase"),F=e("../utils/Utils"),I=e("../utils/OverlapKeeper"),q=e("./IslandManager"),R=e("../objects/RotationalSpring");t.exports=z;if(typeof performance==="undefined"){performance={}}if(!performance.now){var U=Date.now();if(performance.timing&&performance.timing.navigationStart){U=performance.timing.navigationStart}performance.now=function(){return Date.now()-U}}z.prototype=new Object(S.prototype);z.NO_SLEEPING=1;z.BODY_SLEEPING=2;z.ISLAND_SLEEPING=4;z.prototype.addConstraint=function(e){this.constraints.push(e)};z.prototype.addContactMaterial=function(e){this.contactMaterials.push(e)};z.prototype.removeContactMaterial=function(e){var t=this.contactMaterials.indexOf(e);if(t!==-1){F.splice(this.contactMaterials,t,1)}};z.prototype.getContactMaterial=function(e,t){var n=this.contactMaterials;for(var r=0,i=n.length;r!==i;r++){var s=n[r];if(s.materialA.id===e.id&&s.materialB.id===t.id||s.materialA.id===t.id&&s.materialB.id===e.id){return s}}return false};z.prototype.removeConstraint=function(e){var t=this.constraints.indexOf(e);if(t!==-1){F.splice(this.constraints,t,1)}};var W=d.create(),X=d.create(),V=d.create(),$=d.create(),J=d.create(),K=d.create(),Q=d.create(),G=d.fromValues(0,0),Y=d.fromValues(0,0),Z=d.fromValues(0,0),et=d.fromValues(0,0);z.prototype.step=function(e,t,n){n=n||10;t=t||0;if(t===0){this.internalStep(e);this.time+=e}else{var r=Math.floor((this.time+t)/e)-Math.floor(this.time/e);r=Math.min(r,n);var i=performance.now();for(var s=0;s!==r;s++){this.internalStep(e);if(performance.now()-i>e*1e3){break}}this.time+=t;var o=this.time%e;var u=o/e;for(var a=0;a!==this.bodies.length;a++){var f=this.bodies[a];if(f.type!==x.STATIC&&f.sleepState!==x.SLEEPING){d.sub(et,f.position,f.previousPosition);d.scale(et,et,u);d.add(f.interpolatedPosition,f.position,et);f.interpolatedAngle=f.angle+(f.angle-f.previousAngle)*u}else{d.copy(f.interpolatedPosition,f.position);f.interpolatedAngle=f.angle}}}};var tt=[];z.prototype.internalStep=function(e){this.stepping=true;var t=this,n=this.doProfiling,r=this.springs.length,i=this.springs,s=this.bodies,o=this.gravity,u=this.solver,a=this.bodies.length,f=this.broadphase,l=this.narrowphase,c=this.constraints,h,p,v=J,m=K,g=Q,y=d.scale,b=d.add,w=d.rotate,E=this.islandManager;this.overlapKeeper.tick();this.lastTimeStep=e;if(n){h=performance.now()}if(this.useWorldGravityAsFrictionGravity){var S=d.length(this.gravity);if(S===0&&this.useFrictionGravityOnZeroGravity){}else{this.frictionGravity=S}}if(this.applyGravity){for(var T=0;T!==a;T++){var N=s[T],C=N.force;if(N.type!==x.DYNAMIC||N.sleepState===x.SLEEPING){continue}d.scale(g,o,N.mass*N.gravityScale);b(C,C,g)}}if(this.applySpringForces){for(var T=0;T!==r;T++){var k=i[T];k.applyForce()}}if(this.applyDamping){for(var T=0;T!==a;T++){var N=s[T];if(N.type===x.DYNAMIC){N.applyDamping(e)}}}var L=f.getCollisionPairs(this);var A=this.disabledBodyCollisionPairs;for(var T=A.length-2;T>=0;T-=2){for(var O=L.length-2;O>=0;O-=2){if(A[T]===L[O]&&A[T+1]===L[O+1]||A[T+1]===L[O]&&A[T]===L[O+1]){L.splice(O,2)}}}var M=c.length;for(T=0;T!==M;T++){var _=c[T];if(!_.collideConnected){for(var O=L.length-2;O>=0;O-=2){if(_.bodyA===L[O]&&_.bodyB===L[O+1]||_.bodyB===L[O]&&_.bodyA===L[O+1]){L.splice(O,2)}}}}this.postBroadphaseEvent.pairs=L;this.emit(this.postBroadphaseEvent);l.reset(this);for(var T=0,D=L.length;T!==D;T+=2){var P=L[T],H=L[T+1];for(var B=0,j=P.shapes.length;B!==j;B++){var I=P.shapes[B],q=P.shapeOffsets[B],R=P.shapeAngles[B];for(var U=0,W=H.shapes.length;U!==W;U++){var X=H.shapes[U],V=H.shapeOffsets[U],$=H.shapeAngles[U];var G=this.defaultContactMaterial;if(I.material&&X.material){var Y=this.getContactMaterial(I.material,X.material);if(Y){G=Y}}this.runNarrowphase(l,P,I,q,R,H,X,V,$,G,this.frictionGravity)}}}for(var T=0;T!==a;T++){var Z=s[T];if(Z._wakeUpAfterNarrowphase){Z.wakeUp();Z._wakeUpAfterNarrowphase=false}}if(this.has("endContact")){this.overlapKeeper.getEndOverlaps(tt);var et=this.endContactEvent;var U=tt.length;while(U--){var nt=tt[U];et.shapeA=nt.shapeA;et.shapeB=nt.shapeB;et.bodyA=nt.bodyA;et.bodyB=nt.bodyB;this.emit(et)}}var rt=this.preSolveEvent;rt.contactEquations=l.contactEquations;rt.frictionEquations=l.frictionEquations;this.emit(rt);var M=c.length;for(T=0;T!==M;T++){c[T].update()}if(l.contactEquations.length||l.frictionEquations.length||c.length){if(this.islandSplit){E.equations.length=0;F.appendArray(E.equations,l.contactEquations);F.appendArray(E.equations,l.frictionEquations);for(T=0;T!==M;T++){F.appendArray(E.equations,c[T].equations)}E.split(this);for(var T=0;T!==E.islands.length;T++){var it=E.islands[T];if(it.equations.length){u.solveIsland(e,it)}}}else{u.addEquations(l.contactEquations);u.addEquations(l.frictionEquations);for(T=0;T!==M;T++){u.addEquations(c[T].equations)}if(this.solveConstraints){u.solve(e,this)}u.removeAllEquations()}}for(var T=0;T!==a;T++){var Z=s[T];if(Z.sleepState!==x.SLEEPING&&Z.type!==x.STATIC){z.integrateBody(Z,e)}}for(var T=0;T!==a;T++){s[T].setZeroForce()}if(n){p=performance.now();t.lastStepTime=p-h}if(this.emitImpactEvent&&this.has("impact")){var st=this.impactEvent;for(var T=0;T!==l.contactEquations.length;T++){var ot=l.contactEquations[T];if(ot.firstImpact){st.bodyA=ot.bodyA;st.bodyB=ot.bodyB;st.shapeA=ot.shapeA;st.shapeB=ot.shapeB;st.contactEquation=ot;this.emit(st)}}}if(this.sleepMode===z.BODY_SLEEPING){for(T=0;T!==a;T++){s[T].sleepTick(this.time,false,e)}}else if(this.sleepMode===z.ISLAND_SLEEPING&&this.islandSplit){for(T=0;T!==a;T++){s[T].sleepTick(this.time,true,e)}for(var T=0;T<this.islandManager.islands.length;T++){var it=this.islandManager.islands[T];if(it.wantsToSleep()){it.sleep()}}}this.stepping=false;if(this.bodiesToBeRemoved.length){for(var T=0;T!==this.bodiesToBeRemoved.length;T++){this.removeBody(this.bodiesToBeRemoved[T])}this.bodiesToBeRemoved.length=0}this.emit(this.postStepEvent)};var nt=d.create();var rt=d.create();z.integrateBody=function(e,t){var n=e.invMass,r=e.force,i=e.position,s=e.velocity;d.copy(e.previousPosition,e.position);e.previousAngle=e.angle;if(!e.fixedRotation){e.angularVelocity+=e.angularForce*e.invInertia*t;e.angle+=e.angularVelocity*t}d.scale(nt,r,t*n);d.add(s,nt,s);d.scale(rt,s,t);d.add(i,i,rt);e.aabbNeedsUpdate=true};z.prototype.runNarrowphase=function(e,t,n,r,i,s,o,u,a,f,l){if(!((n.collisionGroup&o.collisionMask)!==0&&(o.collisionGroup&n.collisionMask)!==0)){return}d.rotate(G,r,t.angle);d.rotate(Y,u,s.angle);d.add(G,G,t.position);d.add(Y,Y,s.position);var c=i+t.angle;var h=a+s.angle;e.enableFriction=f.friction>0;e.frictionCoefficient=f.friction;var p;if(t.type===x.STATIC||t.type===x.KINEMATIC){p=s.mass}else if(s.type===x.STATIC||s.type===x.KINEMATIC){p=t.mass}else{p=t.mass*s.mass/(t.mass+s.mass)}e.slipForce=f.friction*l*p;e.restitution=f.restitution;e.surfaceVelocity=f.surfaceVelocity;e.frictionStiffness=f.frictionStiffness;e.frictionRelaxation=f.frictionRelaxation;e.stiffness=f.stiffness;e.relaxation=f.relaxation;e.contactSkinSize=f.contactSkinSize;var v=e[n.type|o.type],m=0;if(v){var g=n.sensor||o.sensor;var y=e.frictionEquations.length;if(n.type<o.type){m=v.call(e,t,n,G,c,s,o,Y,h,g)}else{m=v.call(e,s,o,Y,h,t,n,G,c,g)}var b=e.frictionEquations.length-y;if(m){if(t.allowSleep&&t.type===x.DYNAMIC&&t.sleepState===x.SLEEPING&&s.sleepState===x.AWAKE&&s.type!==x.STATIC){var w=d.squaredLength(s.velocity)+Math.pow(s.angularVelocity,2);var E=Math.pow(s.sleepSpeedLimit,2);if(w>=E*2){t._wakeUpAfterNarrowphase=true}}if(s.allowSleep&&s.type===x.DYNAMIC&&s.sleepState===x.SLEEPING&&t.sleepState===x.AWAKE&&t.type!==x.STATIC){var S=d.squaredLength(t.velocity)+Math.pow(t.angularVelocity,2);var T=Math.pow(t.sleepSpeedLimit,2);if(S>=T*2){s._wakeUpAfterNarrowphase=true}}this.overlapKeeper.setOverlapping(t,n,s,o);if(this.has("beginContact")&&this.overlapKeeper.isNewOverlap(n,o)){var N=this.beginContactEvent;N.shapeA=n;N.shapeB=o;N.bodyA=t;N.bodyB=s;N.contactEquations.length=0;if(typeof m==="number"){for(var C=e.contactEquations.length-m;C<e.contactEquations.length;C++){N.contactEquations.push(e.contactEquations[C])}}this.emit(N)}if(typeof m==="number"&&b>1){for(var C=e.frictionEquations.length-b;C<e.frictionEquations.length;C++){var k=e.frictionEquations[C];k.setSlipForce(k.getSlipForce()/b)}}}}};z.prototype.addSpring=function(e){this.springs.push(e);this.addSpringEvent.spring=e;this.emit(this.addSpringEvent)};z.prototype.removeSpring=function(e){var t=this.springs.indexOf(e);if(t!==-1){F.splice(this.springs,t,1)}};z.prototype.addBody=function(e){if(this.bodies.indexOf(e)===-1){this.bodies.push(e);e.world=this;this.addBodyEvent.body=e;this.emit(this.addBodyEvent)}};z.prototype.removeBody=function(e){if(this.stepping){this.bodiesToBeRemoved.push(e)}else{e.world=null;var t=this.bodies.indexOf(e);if(t!==-1){F.splice(this.bodies,t,1);this.removeBodyEvent.body=e;e.resetConstraintVelocity();this.emit(this.removeBodyEvent)}}};z.prototype.getBodyById=function(e){var t=this.bodies;for(var n=0;n<t.length;n++){var r=t[n];if(r.id===e){return r}}return false};z.prototype.disableBodyCollision=function(e,t){this.disabledBodyCollisionPairs.push(e,t)};z.prototype.enableBodyCollision=function(e,t){var n=this.disabledBodyCollisionPairs;for(var r=0;r<n.length;r+=2){if(n[r]===e&&n[r+1]===t||n[r+1]===e&&n[r]===t){n.splice(r,2);return}}};z.prototype.clear=function(){this.time=0;this.fixedStepTime=0;if(this.solver&&this.solver.equations.length){this.solver.removeAllEquations()}var e=this.constraints;for(var t=e.length-1;t>=0;t--){this.removeConstraint(e[t])}var n=this.bodies;for(var t=n.length-1;t>=0;t--){this.removeBody(n[t])}var r=this.springs;for(var t=r.length-1;t>=0;t--){this.removeSpring(r[t])}var i=this.contactMaterials;for(var t=i.length-1;t>=0;t--){this.removeContactMaterial(i[t])}z.apply(this)};z.prototype.clone=function(){var e=new z;e.fromJSON(this.toJSON());return e};var ut=d.create(),at=d.fromValues(0,0),ft=d.fromValues(0,0);z.prototype.hitTest=function(e,t,n){n=n||0;var r=new x({position:e}),i=new E,s=e,o=0,u=ut,a=at,f=ft;r.addShape(i);var l=this.narrowphase,c=[];for(var h=0,p=t.length;h!==p;h++){var m=t[h];for(var y=0,S=m.shapes.length;y!==S;y++){var T=m.shapes[y],N=m.shapeOffsets[y]||a,C=m.shapeAngles[y]||0;d.rotate(u,N,m.angle);d.add(u,u,m.position);var k=C+m.angle;if(T instanceof v&&l.circleParticle(m,T,u,k,r,i,s,o,true)||T instanceof g&&l.particleConvex(r,i,s,o,m,T,u,k,true)||T instanceof b&&l.particlePlane(r,i,s,o,m,T,u,k,true)||T instanceof w&&l.particleCapsule(r,i,s,o,m,T,u,k,true)||T instanceof E&&d.squaredLength(d.sub(f,u,e))<n*n){c.push(m)}}}return c};z.prototype.setGlobalEquationParameters=function(e){e=e||{};for(var t=0;t!==this.constraints.length;t++){var n=this.constraints[t];for(var r=0;r!==n.equations.length;r++){var i=n.equations[r];if(typeof e.stiffness!=="undefined"){i.stiffness=e.stiffness}if(typeof e.relaxation!=="undefined"){i.relaxation=e.relaxation}i.needsUpdate=true}}for(var t=0;t!==this.contactMaterials.length;t++){var n=this.contactMaterials[t];if(typeof e.stiffness!=="undefined"){n.stiffness=e.stiffness;n.frictionStiffness=e.stiffness}if(typeof e.relaxation!=="undefined"){n.relaxation=e.relaxation;n.frictionRelaxation=e.relaxation}}var n=this.defaultContactMaterial;if(typeof e.stiffness!=="undefined"){n.stiffness=e.stiffness;n.frictionStiffness=e.stiffness}if(typeof e.relaxation!=="undefined"){n.relaxation=e.relaxation;n.frictionRelaxation=e.relaxation}};z.prototype.setGlobalStiffness=function(e){this.setGlobalEquationParameters({stiffness:e})};z.prototype.setGlobalRelaxation=function(e){this.setGlobalEquationParameters({relaxation:e})}}).call(this,e("/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js"),typeof self!=="undefined"?self:typeof window!=="undefined"?window:{},e("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/world/World.js","/world")},{"../../package.json":10,"../collision/Broadphase":12,"../collision/NaiveBroadphase":14,"../collision/Narrowphase":15,"../collision/SAPBroadphase":16,"../constraints/Constraint":17,"../constraints/DistanceConstraint":18,"../constraints/GearConstraint":19,"../constraints/LockConstraint":20,"../constraints/PrismaticConstraint":21,"../constraints/RevoluteConstraint":22,"../events/EventEmitter":29,"../material/ContactMaterial":30,"../material/Material":31,"../math/vec2":33,"../objects/Body":34,"../objects/LinearSpring":35,"../objects/RotationalSpring":36,"../shapes/Capsule":39,"../shapes/Circle":40,"../shapes/Convex":41,"../shapes/Line":43,"../shapes/Particle":44,"../shapes/Plane":45,"../shapes/Rectangle":46,"../shapes/Shape":47,"../solver/GSSolver":48,"../solver/Solver":49,"../utils/OverlapKeeper":50,"../utils/Utils":52,"./IslandManager":54,"/Users/schteppe/git/p2.js/node_modules/grunt-browserify/node_modules/browserify/node_modules/insert-module-globals/node_modules/process/browser.js":4,buffer:1}]},{},[38])(38)});